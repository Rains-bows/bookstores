import{k as e,l as o,r as s,m as n,b as a,w as t,i as l,o as i,d,e as u,t as r,I as c,p as h}from"./index-ClAhF9Bg.js";import{r as m}from"./request.QWExmb5c.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=p({data:()=>({loginForm:{username:"",password:""},secondPassword:"",showSecondAuth:!1,ADMIN_SECOND_PASSWORD:"admin888",EMPLOYEE_JUDGE_PASSWORD:"xiaoshou888"}),methods:{async handleFirstAuth(){var s;if(this.loginForm.username&&this.loginForm.password)if("admin"===this.loginForm.username)try{const n=await(s=this.loginForm,m({url:"/user/login",method:"POST",data:s}));1===n.code?(o("token",n.data.token),o("userInfo",{userId:n.data.userId,username:n.data.username}),this.showSecondAuth=!0):e({title:n.message||"登录失败",icon:"none"})}catch(n){console.error("登录失败:",n),e({title:"登录失败，请稍后重试",icon:"none"})}else e({title:"没有管理权限",icon:"none"});else e({title:"请输入用户名和密码",icon:"none"})},handleSecondAuth(){this.secondPassword?(this.secondPassword===this.ADMIN_SECOND_PASSWORD?(o("adminAuth",!0),e({title:"验证成功",icon:"success"}),setTimeout((()=>{s({url:"/pages/index/index"})}),1500)):e({title:"二级密码错误",icon:"none"}),this.secondPassword===this.EMPLOYEE_JUDGE_PASSWORD?(o("adminAuth",!0),e({title:"验证成功",icon:"success"}),setTimeout((()=>{s({url:"/pages/xiaoshou/xiaoshou"})}),1500)):e({title:"二级密码错误",icon:"none"})):e({title:"请输入二级密码",icon:"none"})},handleBack(){this.showSecondAuth=!1,this.secondPassword="",n("token"),n("userInfo")}}},[["render",function(e,o,s,n,m,p){const _=l,f=c,g=h;return i(),a(_,{class:"login-container"},{default:t((()=>[d(_,{class:"login-box"},{default:t((()=>[d(_,{class:"title"},{default:t((()=>[u(r(m.showSecondAuth?"二级验证":"管理员登录"),1)])),_:1}),m.showSecondAuth?(i(),a(_,{key:1,class:"input-group"},{default:t((()=>[d(_,{class:"auth-tip"},{default:t((()=>[u("请输入管理员/销售的二级密码进行验证")])),_:1}),d(f,{class:"input-item",type:"password",modelValue:m.secondPassword,"onUpdate:modelValue":o[2]||(o[2]=e=>m.secondPassword=e),placeholder:"请输入二级密码",onConfirm:p.handleSecondAuth},null,8,["modelValue","onConfirm"]),d(g,{class:"login-btn",onClick:p.handleSecondAuth},{default:t((()=>[u("验证")])),_:1},8,["onClick"]),d(_,{class:"back-btn",onClick:p.handleBack},{default:t((()=>[u("返回重新登录")])),_:1},8,["onClick"])])),_:1})):(i(),a(_,{key:0,class:"input-group"},{default:t((()=>[d(f,{class:"input-item",type:"text",modelValue:m.loginForm.username,"onUpdate:modelValue":o[0]||(o[0]=e=>m.loginForm.username=e),placeholder:"请输入用户名"},null,8,["modelValue"]),d(f,{class:"input-item",type:"password",modelValue:m.loginForm.password,"onUpdate:modelValue":o[1]||(o[1]=e=>m.loginForm.password=e),placeholder:"请输入密码"},null,8,["modelValue"]),d(g,{class:"login-btn",onClick:p.handleFirstAuth},{default:t((()=>[u("登录")])),_:1},8,["onClick"])])),_:1}))])),_:1})])),_:1})}],["__scopeId","data-v-53bcdb3e"]]);export{_ as default};
