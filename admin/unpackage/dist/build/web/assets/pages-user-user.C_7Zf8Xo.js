import{f as t,J as e,e as n,F as r,h as s,d as i,K as o,L as a,q as u,w as l,G as c,C as f,p as h,o as d,t as p,M as g,N as m,T as v}from"./index-ClAhF9Bg.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";const y={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},w=Array.isArray,b=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})();function x(t,e){if(w(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const A=Object.prototype.hasOwnProperty,S={brackets:t=>String(t)+"[]",comma:"comma",indices:(t,e)=>String(t)+"["+e+"]",repeat:t=>String(t)},R=Array.isArray,I=Array.prototype.push,E=function(t,e){I.apply(t,R(e)?e:[e])},k=Date.prototype.toISOString,$={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(t,e,n,r,s)=>{if(0===t.length)return t;let i=t;if("symbol"==typeof t?i=Symbol.prototype.toString.call(t):"string"!=typeof t&&(i=String(t)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));let o="";for(let a=0;a<i.length;a+=1024){const t=i.length>=1024?i.slice(a,a+1024):i,e=[];for(let n=0;n<t.length;++n){let r=t.charCodeAt(n);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===s&&(40===r||41===r)?e[e.length]=t.charAt(n):r<128?e[e.length]=b[r]:r<2048?e[e.length]=b[192|r>>6]+b[128|63&r]:r<55296||r>=57344?e[e.length]=b[224|r>>12]+b[128|r>>6&63]+b[128|63&r]:(n+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e[e.length]=b[240|r>>18]+b[128|r>>12&63]+b[128|r>>6&63]+b[128|63&r])}o+=e.join("")}return o},encodeValuesOnly:!1,format:"RFC3986",formatter:y.RFC3986,indices:!1,serializeDate:t=>k.call(t),skipNulls:!1,strictNullHandling:!1};const O={};function P(t,e,n,r,s,i,o,a,u,l,c,f,h,d,p,g,m,v){let _=t,y=v,w=0,b=!1;for(;void 0!==(y=y.get(O))&&!b;){const e=y.get(t);if(w+=1,void 0!==e){if(e===w)throw new RangeError("Cyclic object value");b=!0}void 0===y.get(O)&&(w=0)}if("function"==typeof l?_=l(e,_):_ instanceof Date?_=null==h?void 0:h(_):"comma"===n&&R(_)&&(_=x(_,(function(t){return t instanceof Date?null==h?void 0:h(t):t}))),null===_){if(i)return u&&!g?u(e,$.encoder,m,"key",d):e;_=""}if("string"==typeof(A=_)||"number"==typeof A||"boolean"==typeof A||"symbol"==typeof A||"bigint"==typeof A||function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))}(_)){if(u){const t=g?e:u(e,$.encoder,m,"key",d);return[(null==p?void 0:p(t))+"="+(null==p?void 0:p(u(_,$.encoder,m,"value",d)))]}return[(null==p?void 0:p(e))+"="+(null==p?void 0:p(String(_)))]}var A;const S=[];if(void 0===_)return S;let I;if("comma"===n&&R(_))g&&u&&(_=x(_,u)),I=[{value:_.length>0?_.join(",")||null:void 0}];else if(R(l))I=l;else{const t=Object.keys(_);I=c?t.sort(c):t}const k=a?String(e).replace(/\./g,"%2E"):String(e),C=r&&R(_)&&1===_.length?k+"[]":k;if(s&&R(_)&&0===_.length)return C+"[]";for(let x=0;x<I.length;++x){const e=I[x],y="object"==typeof e&&void 0!==e.value?e.value:_[e];if(o&&null===y)continue;const b=f&&a?e.replace(/\./g,"%2E"):e,A=R(_)?"function"==typeof n?n(C,b):C:C+(f?"."+b:"["+b+"]");v.set(t,w);const k=new WeakMap;k.set(O,v),E(S,P(y,A,n,r,s,i,o,a,"comma"===n&&g&&R(_)?null:u,l,c,f,h,d,p,g,m,k))}return S}function C(t,e={}){let n=t;const r=function(t=$){if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");const e=t.charset||$.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n="RFC3986";if(void 0!==t.format){if(!A.call(y,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=y[n];let s,i=$.filter;if(("function"==typeof t.filter||R(t.filter))&&(i=t.filter),s=t.arrayFormat&&t.arrayFormat in S?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":$.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=void 0===t.allowDots?1==!!t.encodeDotInKeys||$.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:$.addQueryPrefix,allowDots:o,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:$.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:$.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?$.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:$.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:$.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:$.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:$.encodeValuesOnly,filter:i,format:n,formatter:r,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:$.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:$.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:$.strictNullHandling}}(e);let s,i;"function"==typeof r.filter?(i=r.filter,n=i("",n)):R(r.filter)&&(i=r.filter,s=i);const o=[];if("object"!=typeof n||null===n)return"";const a=S[r.arrayFormat],u="comma"===a&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const l=new WeakMap;for(let h=0;h<s.length;++h){const t=s[h];r.skipNulls&&null===n[t]||E(o,P(n[t],t,a,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const c=o.join(r.delimiter);let f=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),c.length>0?f+c:""}let j,T,M,L,B,D,N,W,F,q=!1;class U{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}const z=()=>{j||function(t,e={auto:!1}){if(q)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(j)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${j}'\``);q=e.auto,j=t.kind,T=t.fetch,t.Request,t.Response,t.Headers,M=t.FormData,t.Blob,L=t.File,B=t.ReadableStream,D=t.getMultipartRequestOptions,N=t.getDefaultAgent,W=t.fileFromPath,F=t.isFsReadStream}(function({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(t,e)=>({...e,body:new U(t)}),getDefaultAgent:t=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:t=>!1}}(),{auto:!0})};z();class H extends Error{}class V extends H{constructor(t,e,n,r){super(`${V.makeMessage(t,e,n)}`),this.status=t,this.headers=r,this.request_id=null==r?void 0:r["x-request-id"],this.error=e;const s=e;this.code=null==s?void 0:s.code,this.param=null==s?void 0:s.param,this.type=null==s?void 0:s.type}static makeMessage(t,e,n){const r=(null==e?void 0:e.message)?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,e,n,r){if(!t||!r)return new X({message:n,cause:Ht(e)});const s=null==e?void 0:e.error;return 400===t?new G(t,s,n,r):401===t?new Q(t,s,n,r):403===t?new Z(t,s,n,r):404===t?new Y(t,s,n,r):409===t?new tt(t,s,n,r):422===t?new et(t,s,n,r):429===t?new nt(t,s,n,r):t>=500?new rt(t,s,n,r):new V(t,s,n,r)}}class J extends V{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class X extends V{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),e&&(this.cause=e)}}class K extends X{constructor({message:t}={}){super({message:t??"Request timed out."})}}class G extends V{}class Q extends V{}class Z extends V{}class Y extends V{}class tt extends V{}class et extends V{}class nt extends V{}class rt extends V{}class st extends H{constructor(){super("Could not parse response content as the length limit was reached")}}class it extends H{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var ot,at=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},ut=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class lt{constructor(){ot.set(this,void 0),this.buffer=new Uint8Array,at(this,ot,null,"f")}decode(t){if(null==t)return[];const e=t instanceof ArrayBuffer?new Uint8Array(t):"string"==typeof t?(new TextEncoder).encode(t):t;let n=new Uint8Array(this.buffer.length+e.length);n.set(this.buffer),n.set(e,this.buffer.length),this.buffer=n;const r=[];let s;for(;null!=(s=ct(this.buffer,ut(this,ot,"f")));){if(s.carriage&&null==ut(this,ot,"f")){at(this,ot,s.index,"f");continue}if(null!=ut(this,ot,"f")&&(s.index!==ut(this,ot,"f")+1||s.carriage)){r.push(this.decodeText(this.buffer.slice(0,ut(this,ot,"f")-1))),this.buffer=this.buffer.slice(ut(this,ot,"f")),at(this,ot,null,"f");continue}const t=null!==ut(this,ot,"f")?s.preceding-1:s.preceding,e=this.decodeText(this.buffer.slice(0,t));r.push(e),this.buffer=this.buffer.slice(s.index),at(this,ot,null,"f")}return r}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if("undefined"!=typeof Buffer){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new H(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new H(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new H("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function ct(t,e){for(let n=e??0;n<t.length;n++){if(10===t[n])return{preceding:n,index:n+1,carriage:!1};if(13===t[n])return{preceding:n,index:n+1,carriage:!0}}return null}function ft(t){for(let e=0;e<t.length-1;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}function ht(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return(null==t?void 0:t.done)&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}ot=new WeakMap,lt.NEWLINE_CHARS=new Set(["\n","\r"]),lt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class dt{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let n=!1;return new dt((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(t,e){if(!t.body)throw e.abort(),new H("Attempted to iterate over a response with no body");const n=new pt,r=new lt,s=ht(t.body);for await(const i of async function*(t){let e=new Uint8Array;for await(const n of t){if(null==n)continue;const t=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,s=new Uint8Array(e.length+t.length);for(s.set(e),s.set(t,e.length),e=s;-1!==(r=ft(e));)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}(s))for(const t of r.decode(i)){const e=n.decode(t);e&&(yield e)}for(const i of r.flush()){const t=n.decode(i);t&&(yield t)}}(t,e))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event||n.event.startsWith("response.")||n.event.startsWith("transcript.")){let e;try{e=JSON.parse(n.data)}catch(s){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),s}if(e&&e.error)throw new V(void 0,e.error,void 0,Ct(t.headers));yield e}else{let t;try{t=JSON.parse(n.data)}catch(s){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),s}if("error"==n.event)throw new V(void 0,t.error,t.message,void 0);yield{event:n.event,data:t}}r=!0}catch(s){if(s instanceof Error&&"AbortError"===s.name)return;throw s}finally{r||e.abort()}}),e)}static fromReadableStream(t,e){let n=!1;return new dt((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const e of async function*(){const e=new lt,n=ht(t);for await(const t of n)for(const n of e.decode(t))yield n;for(const t of e.flush())yield t}())r||e&&(yield JSON.parse(e));r=!0}catch(s){if(s instanceof Error&&"AbortError"===s.name)return;throw s}finally{r||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();t.push(r),e.push(r)}return r.shift()}});return[new dt((()=>r(t)),this.controller),new dt((()=>r(e)),this.controller)]}toReadableStream(){const t=this;let e;const n=new TextEncoder;return new B({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:r,done:s}=await e.next();if(s)return t.close();const i=n.encode(JSON.stringify(r)+"\n");t.enqueue(i)}catch(r){t.error(r)}},async cancel(){var t;await(null==(t=e.return)?void 0:t.call(e))}})}}class pt{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,n,r]=function(t,e){const n=t.indexOf(e);if(-1!==n)return[t.substring(0,n),e,t.substring(n+e.length)];return[t,"",""]}(t,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===e?this.event=r:"data"===e&&this.data.push(r),null}}const gt=t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob,mt=t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&vt(t),vt=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;async function _t(t,e,n){var r;if(t=await t,mt(t))return t;if(gt(t)){const r=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=vt(r)?[await r.arrayBuffer()]:[r];return new L(s,e,n)}const s=await async function(t){var e;let n=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)n.push(t);else if(vt(t))n.push(await t.arrayBuffer());else{if(!wt(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${null==(e=null==t?void 0:t.constructor)?void 0:e.name}; props: ${function(t){return`[${Object.getOwnPropertyNames(t).map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const e of t)n.push(e)}return n}(t);if(e||(e=function(t){var e;return yt(t.name)||yt(t.filename)||(null==(e=yt(t.path))?void 0:e.split(/[\\/]/).pop())}(t)??"unknown_file"),!(null==n?void 0:n.type)){const t=null==(r=s[0])?void 0:r.type;"string"==typeof t&&(n={...n,type:t})}return new L(s,e,n)}const yt=t=>"string"==typeof t?t:"undefined"!=typeof Buffer&&t instanceof Buffer?String(t):void 0,wt=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],bt=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag],xt=async t=>{const e=await At(t.body);return D(e,t)},At=async t=>{const e=new M;return await Promise.all(Object.entries(t||{}).map((([t,n])=>St(e,t,n)))),e},St=async(t,e,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)t.append(e,String(n));else if((t=>mt(t)||gt(t)||F(t))(n)){const r=await _t(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>St(t,e+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>St(t,`${e}[${n}]`,r))))}}};var Rt,It={};async function Et(t){var e;const{response:n}=t;if(t.options.stream)return Qt("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller):dt.fromSSEResponse(n,t.controller);if(204===n.status)return null;if(t.options.__binaryResponse)return n;const r=n.headers.get("content-type"),s=null==(e=null==r?void 0:r.split(";")[0])?void 0:e.trim();if((null==s?void 0:s.includes("application/json"))||(null==s?void 0:s.endsWith("+json"))){const t=await n.json();return Qt("response",n.status,n.url,n.headers,t),kt(t,n)}const i=await n.text();return Qt("response",n.status,n.url,n.headers,i),i}function kt(t,e){return!t||"object"!=typeof t||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}z();class $t extends Promise{constructor(t,e=Et){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new $t(this.responsePromise,(async e=>kt(t(await this.parseResponse(e),e),e.response)))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e,request_id:e.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class Ot{constructor(t,e,n,r){Rt.set(this,void 0),function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===r?s.call(t,n):s?s.value=n:e.set(t,n)}(this,Rt,t,"f"),this.options=r,this.response=e,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new H("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const e={...this.options};if("params"in t&&"object"==typeof e.query)e.query={...e.query,...t.params};else if("url"in t){const n=[...Object.entries(e.query||{}),...t.url.searchParams.entries()];for(const[e,r]of n)t.url.searchParams.set(e,r);e.query=void 0,e.path=t.url.toString()}return await function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}(this,Rt,"f").requestAPIList(this.constructor,e)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Rt=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class Pt extends $t{constructor(t,e,n){super(e,(async e=>new n(t,e.response,await Et(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const Ct=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const n=e.toString();return t[n.toLowerCase()]||t[n]}}),jt={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Tt=t=>"object"==typeof t&&null!==t&&!Jt(t)&&Object.keys(t).every((t=>Xt(jt,t))),Mt=()=>{var t;if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":"4.95.1","X-Stainless-OS":Bt(Deno.build.os),"X-Stainless-Arch":Lt(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:(null==(t=Deno.version)?void 0:t.deno)??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":"4.95.1","X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":"4.95.1","X-Stainless-OS":Bt(process.platform),"X-Stainless-Arch":Lt(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const t=n.exec(navigator.userAgent);if(t){return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":"4.95.1","X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":"4.95.1","X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const Lt=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",Bt=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let Dt;const Nt=()=>Dt??(Dt=Mt()),Wt=t=>{try{return JSON.parse(t)}catch(e){return}},Ft=/^[a-z][a-z0-9+.-]*:/i,qt=t=>Ft.test(t),Ut=t=>new Promise((e=>setTimeout(e,t))),zt=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new H(`${t} must be an integer`);if(e<0)throw new H(`${t} must be a positive integer`);return e},Ht=t=>{if(t instanceof Error)return t;if("object"==typeof t&&null!==t)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Vt=t=>{var e,n,r,s;return"undefined"!=typeof process?(null==(e=null==It?void 0:It[t])?void 0:e.trim())??void 0:"undefined"!=typeof Deno?null==(s=null==(r=null==(n=Deno.env)?void 0:n.get)?void 0:r.call(n,t))?void 0:s.trim():void 0};function Jt(t){if(!t)return!0;for(const e in t)return!1;return!0}function Xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Kt(t,e){for(const n in e){if(!Xt(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];null===s?delete t[r]:void 0!==s&&(t[r]=s)}}const Gt=new Set(["authorization","api-key"]);function Qt(t,...e){if("undefined"!=typeof process&&"true"===(null==It?void 0:It.DEBUG)){const n=e.map((t=>{if(!t)return t;if(t.headers){const e={...t,headers:{...t.headers}};for(const n in t.headers)Gt.has(n.toLowerCase())&&(e.headers[n]="REDACTED");return e}let e=null;for(const n in t)Gt.has(n.toLowerCase())&&(e??(e={...t}),e[n]="REDACTED");return e??t}));console.log(`OpenAI:DEBUG:${t}`,...n)}}const Zt=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),Yt=(t,e)=>{var n;const r=e.toLowerCase();if((t=>"function"==typeof(null==t?void 0:t.get))(t)){const s=(null==(n=e[0])?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,((t,e,n)=>e+n.toUpperCase()));for(const n of[e,r,e.toUpperCase(),s]){const e=t.get(n);if(e)return e}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===r)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i};function te(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}class ee extends Ot{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ne extends Ot{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const e=Object.fromEntries(t.url.searchParams);return Object.keys(e).length?e:null}nextPageInfo(){var t;const e=this.getPaginatedItems();if(!e.length)return null;const n=null==(t=e[e.length-1])?void 0:t.id;return n?{params:{after:n}}:null}}class re{constructor(t){this._client=t}}let se=class extends re{list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/chat/completions/${t}/messages`,ae,{query:e,...n})}},ie=class extends re{constructor(){super(...arguments),this.messages=new se(this._client)}create(t,e){return this._client.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}retrieve(t,e){return this._client.get(`/chat/completions/${t}`,e)}update(t,e,n){return this._client.post(`/chat/completions/${t}`,{body:e,...n})}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/chat/completions",oe,{query:t,...e})}del(t,e){return this._client.delete(`/chat/completions/${t}`,e)}};class oe extends ne{}class ae extends ne{}ie.ChatCompletionsPage=oe,ie.Messages=se;let ue=class extends re{constructor(){super(...arguments),this.completions=new ie(this._client)}};ue.Completions=ie,ue.ChatCompletionsPage=oe;class le extends re{create(t,e){return this._client.post("/audio/speech",{body:t,...e,headers:{Accept:"application/octet-stream",...null==e?void 0:e.headers},__binaryResponse:!0})}}class ce extends re{create(t,e){return this._client.post("/audio/transcriptions",xt({body:t,...e,stream:t.stream??!1,__metadata:{model:t.model}}))}}class fe extends re{create(t,e){return this._client.post("/audio/translations",xt({body:t,...e,__metadata:{model:t.model}}))}}class he extends re{constructor(){super(...arguments),this.transcriptions=new ce(this._client),this.translations=new fe(this._client),this.speech=new le(this._client)}}he.Transcriptions=ce,he.Translations=fe,he.Speech=le;class de extends re{create(t,e){return this._client.post("/batches",{body:t,...e})}retrieve(t,e){return this._client.get(`/batches/${t}`,e)}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/batches",pe,{query:t,...e})}cancel(t,e){return this._client.post(`/batches/${t}/cancel`,e)}}class pe extends ne{}de.BatchesPage=pe;class ge extends re{create(t,e){return this._client.post("/assistants",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}retrieve(t,e){return this._client.get(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}update(t,e,n){return this._client.post(`/assistants/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/assistants",me,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}del(t,e){return this._client.delete(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}}class me extends ne{}function ve(t){return"function"==typeof t.parse}ge.AssistantsPage=me;const _e=t=>"assistant"===(null==t?void 0:t.role),ye=t=>"function"===(null==t?void 0:t.role),we=t=>"tool"===(null==t?void 0:t.role);var be,xe,Ae,Se,Re,Ie,Ee,ke,$e,Oe,Pe,Ce,je,Te=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},Me=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Le{constructor(){be.add(this),this.controller=new AbortController,xe.set(this,void 0),Ae.set(this,(()=>{})),Se.set(this,(()=>{})),Re.set(this,void 0),Ie.set(this,(()=>{})),Ee.set(this,(()=>{})),ke.set(this,{}),$e.set(this,!1),Oe.set(this,!1),Pe.set(this,!1),Ce.set(this,!1),Te(this,xe,new Promise(((t,e)=>{Te(this,Ae,t,"f"),Te(this,Se,e,"f")})),"f"),Te(this,Re,new Promise(((t,e)=>{Te(this,Ie,t,"f"),Te(this,Ee,e,"f")})),"f"),Me(this,xe,"f").catch((()=>{})),Me(this,Re,"f").catch((()=>{}))}_run(t){setTimeout((()=>{t().then((()=>{this._emitFinal(),this._emit("end")}),Me(this,be,"m",je).bind(this))}),0)}_connected(){this.ended||(Me(this,Ae,"f").call(this),this._emit("connect"))}get ended(){return Me(this,$e,"f")}get errored(){return Me(this,Oe,"f")}get aborted(){return Me(this,Pe,"f")}abort(){this.controller.abort()}on(t,e){return(Me(this,ke,"f")[t]||(Me(this,ke,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=Me(this,ke,"f")[t];if(!n)return this;const r=n.findIndex((t=>t.listener===e));return r>=0&&n.splice(r,1),this}once(t,e){return(Me(this,ke,"f")[t]||(Me(this,ke,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,n)=>{Te(this,Ce,!0,"f"),"error"!==t&&this.once("error",n),this.once(t,e)}))}async done(){Te(this,Ce,!0,"f"),await Me(this,Re,"f")}_emit(t,...e){if(Me(this,$e,"f"))return;"end"===t&&(Te(this,$e,!0,"f"),Me(this,Ie,"f").call(this));const n=Me(this,ke,"f")[t];if(n&&(Me(this,ke,"f")[t]=n.filter((t=>!t.once)),n.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return Me(this,Ce,"f")||(null==n?void 0:n.length)||Promise.reject(t),Me(this,Se,"f").call(this,t),Me(this,Ee,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];Me(this,Ce,"f")||(null==n?void 0:n.length)||Promise.reject(t),Me(this,Se,"f").call(this,t),Me(this,Ee,"f").call(this,t),this._emit("end")}}_emitFinal(){}}function Be(t){return"auto-parseable-response-format"===(null==t?void 0:t.$brand)}function De(t){return"auto-parseable-tool"===(null==t?void 0:t.$brand)}function Ne(t,e){const n=t.choices.map((t=>{var n;if("length"===t.finish_reason)throw new st;if("content_filter"===t.finish_reason)throw new it;return{...t,message:{...t.message,...t.message.tool_calls?{tool_calls:(null==(n=t.message.tool_calls)?void 0:n.map((t=>function(t,e){var n;const r=null==(n=t.tools)?void 0:n.find((t=>{var n;return(null==(n=t.function)?void 0:n.name)===e.function.name}));return{...e,function:{...e.function,parsed_arguments:De(r)?r.$parseRaw(e.function.arguments):(null==r?void 0:r.function.strict)?JSON.parse(e.function.arguments):null}}}(e,t))))??void 0}:void 0,parsed:t.message.content&&!t.message.refusal?We(e,t.message.content):null}}}));return{...t,choices:n}}function We(t,e){var n,r;if("json_schema"!==(null==(n=t.response_format)?void 0:n.type))return null;if("json_schema"===(null==(r=t.response_format)?void 0:r.type)){if("$parseRaw"in t.response_format){return t.response_format.$parseRaw(e)}return JSON.parse(e)}return null}function Fe(t,e){var n;if(!t)return!1;const r=null==(n=t.tools)?void 0:n.find((t=>{var n;return(null==(n=t.function)?void 0:n.name)===e.function.name}));return De(r)||(null==r?void 0:r.function.strict)||!1}function qe(t){var e;return!!Be(t.response_format)||((null==(e=t.tools)?void 0:e.some((t=>De(t)||"function"===t.type&&!0===t.function.strict)))??!1)}xe=new WeakMap,Ae=new WeakMap,Se=new WeakMap,Re=new WeakMap,Ie=new WeakMap,Ee=new WeakMap,ke=new WeakMap,$e=new WeakMap,Oe=new WeakMap,Pe=new WeakMap,Ce=new WeakMap,be=new WeakSet,je=function(t){if(Te(this,Oe,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new J),t instanceof J)return Te(this,Pe,!0,"f"),this._emit("abort",t);if(t instanceof H)return this._emit("error",t);if(t instanceof Error){const e=new H(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new H(String(t)))};var Ue,ze,He,Ve,Je,Xe,Ke,Ge,Qe=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};const Ze=10;class Ye extends Le{constructor(){super(...arguments),Ue.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){var e;this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=null==(e=t.choices[0])?void 0:e.message;return n&&this._addMessage(n),t}_addMessage(t,e=!0){if("content"in t||(t.content=null),this.messages.push(t),e)if(this._emit("message",t),(ye(t)||we(t))&&t.content)this._emit("functionCallResult",t.content);else if(_e(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(_e(t)&&t.tool_calls)for(const n of t.tool_calls)"function"===n.type&&this._emit("functionCall",n.function)}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new H("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),Qe(this,Ue,"m",ze).call(this)}async finalMessage(){return await this.done(),Qe(this,Ue,"m",He).call(this)}async finalFunctionCall(){return await this.done(),Qe(this,Ue,"m",Ve).call(this)}async finalFunctionCallResult(){return await this.done(),Qe(this,Ue,"m",Je).call(this)}async totalUsage(){return await this.done(),Qe(this,Ue,"m",Xe).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=Qe(this,Ue,"m",He).call(this);e&&this._emit("finalMessage",e);const n=Qe(this,Ue,"m",ze).call(this);n&&this._emit("finalContent",n);const r=Qe(this,Ue,"m",Ve).call(this);r&&this._emit("finalFunctionCall",r);const s=Qe(this,Ue,"m",Je).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some((t=>t.usage))&&this._emit("totalUsage",Qe(this,Ue,"m",Xe).call(this))}async _createChatCompletion(t,e,n){const r=null==n?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Qe(this,Ue,"m",Ke).call(this,e);const s=await t.chat.completions.create({...e,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Ne(s,e))}async _runChatCompletion(t,e,n){for(const r of e.messages)this._addMessage(r,!1);return await this._createChatCompletion(t,e,n)}async _runFunctions(t,e,n){var r;const s="function",{function_call:i="auto",stream:o,...a}=e,u="string"!=typeof i&&(null==i?void 0:i.name),{maxChatCompletions:l=Ze}=n||{},c={};for(const d of e.functions)c[d.name||d.function.name]=d;const f=e.functions.map((t=>({name:t.name||t.function.name,parameters:t.parameters,description:t.description})));for(const d of e.messages)this._addMessage(d,!1);for(let d=0;d<l;++d){const e=null==(r=(await this._createChatCompletion(t,{...a,function_call:i,functions:f,messages:[...this.messages]},n)).choices[0])?void 0:r.message;if(!e)throw new H("missing message in ChatCompletion response");if(!e.function_call)return;const{name:o,arguments:l}=e.function_call,d=c[o];if(!d){const t=`Invalid function_call: ${JSON.stringify(o)}. Available options are: ${f.map((t=>JSON.stringify(t.name))).join(", ")}. Please try again`;this._addMessage({role:s,name:o,content:t});continue}if(u&&u!==o){const t=`Invalid function_call: ${JSON.stringify(o)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,name:o,content:t});continue}let p;try{p=ve(d)?await d.parse(l):l}catch(h){this._addMessage({role:s,name:o,content:h instanceof Error?h.message:String(h)});continue}const g=await d.function(p,this),m=Qe(this,Ue,"m",Ge).call(this,g);if(this._addMessage({role:s,name:o,content:m}),u)return}}async _runTools(t,e,n){var r,s,i;const o="tool",{tool_choice:a="auto",stream:u,...l}=e,c="string"!=typeof a&&(null==(r=null==a?void 0:a.function)?void 0:r.name),{maxChatCompletions:f=Ze}=n||{},h=e.tools.map((t=>{if(De(t)){if(!t.$callback)throw new H("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:t.$callback,name:t.function.name,description:t.function.description||"",parameters:t.function.parameters,parse:t.$parseRaw,strict:!0}}}return t})),d={};for(const m of h)"function"===m.type&&(d[m.function.name||m.function.function.name]=m.function);const p="tools"in e?h.map((t=>"function"===t.type?{type:"function",function:{name:t.function.name||t.function.function.name,parameters:t.function.parameters,description:t.function.description,strict:t.function.strict}}:t)):void 0;for(const m of e.messages)this._addMessage(m,!1);for(let m=0;m<f;++m){const e=null==(s=(await this._createChatCompletion(t,{...l,tool_choice:a,tools:p,messages:[...this.messages]},n)).choices[0])?void 0:s.message;if(!e)throw new H("missing message in ChatCompletion response");if(!(null==(i=e.tool_calls)?void 0:i.length))return;for(const t of e.tool_calls){if("function"!==t.type)continue;const e=t.id,{name:n,arguments:r}=t.function,s=d[n];if(!s){const t=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(d).map((t=>JSON.stringify(t))).join(", ")}. Please try again`;this._addMessage({role:o,tool_call_id:e,content:t});continue}if(c&&c!==n){const t=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:o,tool_call_id:e,content:t});continue}let i;try{i=ve(s)?await s.parse(r):r}catch(g){const t=g instanceof Error?g.message:String(g);this._addMessage({role:o,tool_call_id:e,content:t});continue}const a=await s.function(i,this),u=Qe(this,Ue,"m",Ge).call(this,a);if(this._addMessage({role:o,tool_call_id:e,content:u}),c)return}}}}Ue=new WeakSet,ze=function(){return Qe(this,Ue,"m",He).call(this).content??null},He=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(_e(e)){const{function_call:t,...n}=e,r={...n,content:e.content??null,refusal:e.refusal??null};return t&&(r.function_call=t),r}}throw new H("stream ended without producing a ChatCompletionMessage with role=assistant")},Ve=function(){var t,e;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(_e(r)&&(null==r?void 0:r.function_call))return r.function_call;if(_e(r)&&(null==(t=null==r?void 0:r.tool_calls)?void 0:t.length))return null==(e=r.tool_calls.at(-1))?void 0:e.function}},Je=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(ye(e)&&null!=e.content)return e.content;if(we(e)&&null!=e.content&&"string"==typeof e.content&&this.messages.some((t=>{var n;return"assistant"===t.role&&(null==(n=t.tool_calls)?void 0:n.some((t=>"function"===t.type&&t.id===e.tool_call_id)))})))return e.content}},Xe=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},Ke=function(t){if(null!=t.n&&t.n>1)throw new H("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ge=function(t){return"string"==typeof t?t:void 0===t?"undefined":JSON.stringify(t)};class tn extends Ye{static runFunctions(t,e,n){const r=new tn,s={...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(t,e,s))),r}static runTools(t,e,n){const r=new tn,s={...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(t,e,s))),r}_addMessage(t,e=!0){super._addMessage(t,e),_e(t)&&t.content&&this._emit("content",t.content)}}const en=1,nn=2,rn=4,sn=8,on=16,an=32,un=64,ln=128,cn=256,fn=511;class hn extends Error{}class dn extends Error{}const pn=(t,e)=>{const n=t.length;let r=0;const s=t=>{throw new hn(`${t} at position ${r}`)},i=t=>{throw new dn(`${t} at position ${r}`)},o=()=>(f(),r>=n&&s("Unexpected end of input"),'"'===t[r]?a():"{"===t[r]?u():"["===t[r]?l():"null"===t.substring(r,r+4)||on&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):"true"===t.substring(r,r+4)||an&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):"false"===t.substring(r,r+5)||an&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):"Infinity"===t.substring(r,r+8)||ln&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):"-Infinity"===t.substring(r,r+9)||cn&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):"NaN"===t.substring(r,r+3)||un&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):c()),a=()=>{const o=r;let a=!1;for(r++;r<n&&('"'!==t[r]||a&&"\\"===t[r-1]);)a="\\"===t[r]&&!a,r++;if('"'==t.charAt(r))try{return JSON.parse(t.substring(o,++r-Number(a)))}catch(u){i(String(u))}else if(en&e)try{return JSON.parse(t.substring(o,r-Number(a))+'"')}catch(u){return JSON.parse(t.substring(o,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},u=()=>{r++,f();const i={};try{for(;"}"!==t[r];){if(f(),r>=n&&sn&e)return i;const s=a();f(),r++;try{const t=o();Object.defineProperty(i,s,{value:t,writable:!0,enumerable:!0,configurable:!0})}catch(u){if(sn&e)return i;throw u}f(),","===t[r]&&r++}}catch(u){if(sn&e)return i;s("Expected '}' at end of object")}return r++,i},l=()=>{r++;const n=[];try{for(;"]"!==t[r];)n.push(o()),f(),","===t[r]&&r++}catch(i){if(rn&e)return n;s("Expected ']' at end of array")}return r++,n},c=()=>{if(0===r){"-"===t&&nn&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(a){if(nn&e)try{return"."===t[t.length-1]?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch(u){}i(String(a))}}const o=r;for("-"===t[r]&&r++;t[r]&&!",]}".includes(t[r]);)r++;r!=n||nn&e||s("Unterminated number literal");try{return JSON.parse(t.substring(o,r))}catch(a){"-"===t.substring(o,r)&&nn&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(o,t.lastIndexOf("e")))}catch(u){i(String(u))}}},f=()=>{for(;r<n&&" \n\r\t".includes(t[r]);)r++};return o()},gn=t=>function(t,e=fn){if("string"!=typeof t)throw new TypeError("expecting str, got "+typeof t);if(!t.trim())throw new Error(`${t} is empty`);return pn(t.trim(),e)}(t,fn^nn);var mn,vn,_n,yn,wn,bn,xn,An,Sn,Rn,In,En,kn=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},$n=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class On extends Ye{constructor(t){super(),mn.add(this),vn.set(this,void 0),_n.set(this,void 0),yn.set(this,void 0),kn(this,vn,t,"f"),kn(this,_n,[],"f")}get currentChatCompletionSnapshot(){return $n(this,yn,"f")}static fromReadableStream(t){const e=new On(null);return e._run((()=>e._fromReadableStream(t))),e}static createChatCompletion(t,e,n){const r=new On(e);return r._run((()=>r._runChatCompletion(t,{...e,stream:!0},{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(t,e,n){var r;super._createChatCompletion;const s=null==n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),$n(this,mn,"m",wn).call(this);const i=await t.chat.completions.create({...e,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)$n(this,mn,"m",xn).call(this,o);if(null==(r=i.controller.signal)?void 0:r.aborted)throw new J;return this._addChatCompletion($n(this,mn,"m",Rn).call(this))}async _fromReadableStream(t,e){var n;const r=null==e?void 0:e.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),$n(this,mn,"m",wn).call(this),this._connected();const s=dt.fromReadableStream(t,this.controller);let i;for await(const o of s)i&&i!==o.id&&this._addChatCompletion($n(this,mn,"m",Rn).call(this)),$n(this,mn,"m",xn).call(this,o),i=o.id;if(null==(n=s.controller.signal)?void 0:n.aborted)throw new J;return this._addChatCompletion($n(this,mn,"m",Rn).call(this))}[(vn=new WeakMap,_n=new WeakMap,yn=new WeakMap,mn=new WeakSet,wn=function(){this.ended||kn(this,yn,void 0,"f")},bn=function(t){let e=$n(this,_n,"f")[t.index];return e||(e={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},$n(this,_n,"f")[t.index]=e,e)},xn=function(t){var e,n,r,s,i,o,a,u,l,c,f,h,d,p,g;if(this.ended)return;const m=$n(this,mn,"m",En).call(this,t);this._emit("chunk",t,m);for(const v of t.choices){const t=m.choices[v.index];null!=v.delta.content&&"assistant"===(null==(e=t.message)?void 0:e.role)&&(null==(n=t.message)?void 0:n.content)&&(this._emit("content",v.delta.content,t.message.content),this._emit("content.delta",{delta:v.delta.content,snapshot:t.message.content,parsed:t.message.parsed})),null!=v.delta.refusal&&"assistant"===(null==(r=t.message)?void 0:r.role)&&(null==(s=t.message)?void 0:s.refusal)&&this._emit("refusal.delta",{delta:v.delta.refusal,snapshot:t.message.refusal}),null!=(null==(i=v.logprobs)?void 0:i.content)&&"assistant"===(null==(o=t.message)?void 0:o.role)&&this._emit("logprobs.content.delta",{content:null==(a=v.logprobs)?void 0:a.content,snapshot:(null==(u=t.logprobs)?void 0:u.content)??[]}),null!=(null==(l=v.logprobs)?void 0:l.refusal)&&"assistant"===(null==(c=t.message)?void 0:c.role)&&this._emit("logprobs.refusal.delta",{refusal:null==(f=v.logprobs)?void 0:f.refusal,snapshot:(null==(h=t.logprobs)?void 0:h.refusal)??[]});const _=$n(this,mn,"m",bn).call(this,t);t.finish_reason&&($n(this,mn,"m",Sn).call(this,t),null!=_.current_tool_call_index&&$n(this,mn,"m",An).call(this,t,_.current_tool_call_index));for(const e of v.delta.tool_calls??[])_.current_tool_call_index!==e.index&&($n(this,mn,"m",Sn).call(this,t),null!=_.current_tool_call_index&&$n(this,mn,"m",An).call(this,t,_.current_tool_call_index)),_.current_tool_call_index=e.index;for(const e of v.delta.tool_calls??[]){const n=null==(d=t.message.tool_calls)?void 0:d[e.index];(null==n?void 0:n.type)&&("function"===(null==n?void 0:n.type)?this._emit("tool_calls.function.arguments.delta",{name:null==(p=n.function)?void 0:p.name,index:e.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:(null==(g=e.function)?void 0:g.arguments)??""}):null==n||n.type)}}},An=function(t,e){var n,r,s;if($n(this,mn,"m",bn).call(this,t).done_tool_calls.has(e))return;const i=null==(n=t.message.tool_calls)?void 0:n[e];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if("function"===i.type){const t=null==(s=null==(r=$n(this,vn,"f"))?void 0:r.tools)?void 0:s.find((t=>"function"===t.type&&t.function.name===i.function.name));this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:e,arguments:i.function.arguments,parsed_arguments:De(t)?t.$parseRaw(i.function.arguments):(null==t?void 0:t.function.strict)?JSON.parse(i.function.arguments):null})}else i.type},Sn=function(t){var e,n;const r=$n(this,mn,"m",bn).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const e=$n(this,mn,"m",In).call(this);this._emit("content.done",{content:t.message.content,parsed:e?e.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(null==(e=t.logprobs)?void 0:e.content)&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(null==(n=t.logprobs)?void 0:n.refusal)&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Rn=function(){if(this.ended)throw new H("stream has ended, this shouldn't happen");const t=$n(this,yn,"f");if(!t)throw new H("request ended without sending any chunks");return kn(this,yn,void 0,"f"),kn(this,_n,[],"f"),function(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...a}=t;return function(t,e){return e&&qe(e)?Ne(t,e):{...t,choices:t.choices.map((t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}})))}}({...a,id:n,choices:r.map((({message:e,finish_reason:n,index:r,logprobs:s,...i})=>{if(!n)throw new H(`missing finish_reason for choice ${r}`);const{content:o=null,function_call:a,tool_calls:u,...l}=e,c=e.role;if(!c)throw new H(`missing role for choice ${r}`);if(a){const{arguments:t,name:u}=a;if(null==t)throw new H(`missing function_call.arguments for choice ${r}`);if(!u)throw new H(`missing function_call.name for choice ${r}`);return{...i,message:{content:o,function_call:{arguments:t,name:u},role:c,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}}return u?{...i,index:r,finish_reason:n,logprobs:s,message:{...l,role:c,content:o,refusal:e.refusal??null,tool_calls:u.map(((e,n)=>{const{function:s,type:i,id:o,...a}=e,{arguments:u,name:l,...c}=s||{};if(null==o)throw new H(`missing choices[${r}].tool_calls[${n}].id\n${Pn(t)}`);if(null==i)throw new H(`missing choices[${r}].tool_calls[${n}].type\n${Pn(t)}`);if(null==l)throw new H(`missing choices[${r}].tool_calls[${n}].function.name\n${Pn(t)}`);if(null==u)throw new H(`missing choices[${r}].tool_calls[${n}].function.arguments\n${Pn(t)}`);return{...a,id:o,type:i,function:{...c,name:l,arguments:u}}}))}}:{...i,message:{...l,content:o,role:c,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}})),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}},e)}(t,$n(this,vn,"f"))},In=function(){var t;const e=null==(t=$n(this,vn,"f"))?void 0:t.response_format;return Be(e)?e:null},En=function(t){var e,n,r,s;let i=$n(this,yn,"f");const{choices:o,...a}=t;i?Object.assign(i,a):i=kn(this,yn,{...a,choices:[]},"f");for(const{delta:u,finish_reason:l,index:c,logprobs:f=null,...h}of t.choices){let t=i.choices[c];if(t||(t=i.choices[c]={finish_reason:l,index:c,message:{},logprobs:f,...h}),f)if(t.logprobs){const{content:r,refusal:s,...i}=f;Object.assign(t.logprobs,i),r&&((e=t.logprobs).content??(e.content=[]),t.logprobs.content.push(...r)),s&&((n=t.logprobs).refusal??(n.refusal=[]),t.logprobs.refusal.push(...s))}else t.logprobs=Object.assign({},f);if(l&&(t.finish_reason=l,$n(this,vn,"f")&&qe($n(this,vn,"f")))){if("length"===l)throw new st;if("content_filter"===l)throw new it}if(Object.assign(t,h),!u)continue;const{content:o,refusal:a,function_call:d,role:p,tool_calls:g,...m}=u;if(Object.assign(t.message,m),a&&(t.message.refusal=(t.message.refusal||"")+a),p&&(t.message.role=p),d&&(t.message.function_call?(d.name&&(t.message.function_call.name=d.name),d.arguments&&((r=t.message.function_call).arguments??(r.arguments=""),t.message.function_call.arguments+=d.arguments)):t.message.function_call=d),o&&(t.message.content=(t.message.content||"")+o,!t.message.refusal&&$n(this,mn,"m",In).call(this)&&(t.message.parsed=gn(t.message.content))),g){t.message.tool_calls||(t.message.tool_calls=[]);for(const{index:e,id:n,type:r,function:i,...o}of g){const a=(s=t.message.tool_calls)[e]??(s[e]={});Object.assign(a,o),n&&(a.id=n),r&&(a.type=r),i&&(a.function??(a.function={name:i.name??"",arguments:""})),(null==i?void 0:i.name)&&(a.function.name=i.name),(null==i?void 0:i.arguments)&&(a.function.arguments+=i.arguments,Fe($n(this,vn,"f"),a)&&(a.function.parsed_arguments=gn(a.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("chunk",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>{if(!t.length)return n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0}));return{value:t.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new dt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Pn(t){return JSON.stringify(t)}class Cn extends On{static fromReadableStream(t){const e=new Cn(null);return e._run((()=>e._fromReadableStream(t))),e}static runFunctions(t,e,n){const r=new Cn(null),s={...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(t,e,s))),r}static runTools(t,e,n){const r=new Cn(e),s={...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(t,e,s))),r}}let jn=class extends re{parse(t,e){return function(t){for(const e of t??[]){if("function"!==e.type)throw new H(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(!0!==e.function.strict)throw new H(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(t.tools),this._client.chat.completions.create(t,{...e,headers:{...null==e?void 0:e.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((e=>Ne(e,t)))}runFunctions(t,e){return t.stream?Cn.runFunctions(this._client,t,e):tn.runFunctions(this._client,t,e)}runTools(t,e){return t.stream?Cn.runTools(this._client,t,e):tn.runTools(this._client,t,e)}stream(t,e){return On.createChatCompletion(this._client,t,e)}};class Tn extends re{constructor(){super(...arguments),this.completions=new jn(this._client)}}(Tn||(Tn={})).Completions=jn;class Mn extends re{create(t,e){return this._client.post("/realtime/sessions",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}}class Ln extends re{create(t,e){return this._client.post("/realtime/transcription_sessions",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}}class Bn extends re{constructor(){super(...arguments),this.sessions=new Mn(this._client),this.transcriptionSessions=new Ln(this._client)}}Bn.Sessions=Mn,Bn.TranscriptionSessions=Ln;var Dn,Nn,Wn,Fn,qn,Un,zn,Hn,Vn,Jn,Xn,Kn,Gn,Qn,Zn,Yn,tr,er,nr,rr,sr,ir,or=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},ar=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n};class ur extends Le{constructor(){super(...arguments),Dn.add(this),Nn.set(this,[]),Wn.set(this,{}),Fn.set(this,{}),qn.set(this,void 0),Un.set(this,void 0),zn.set(this,void 0),Hn.set(this,void 0),Vn.set(this,void 0),Jn.set(this,void 0),Xn.set(this,void 0),Kn.set(this,void 0),Gn.set(this,void 0)}[(Nn=new WeakMap,Wn=new WeakMap,Fn=new WeakMap,qn=new WeakMap,Un=new WeakMap,zn=new WeakMap,Hn=new WeakMap,Vn=new WeakMap,Jn=new WeakMap,Xn=new WeakMap,Kn=new WeakMap,Gn=new WeakMap,Dn=new WeakSet,Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("event",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>{if(!t.length)return n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0}));return{value:t.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const e=new ur;return e._run((()=>e._fromReadableStream(t))),e}async _fromReadableStream(t,e){var n;const r=null==e?void 0:e.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const s=dt.fromReadableStream(t,this.controller);for await(const i of s)or(this,Dn,"m",Qn).call(this,i);if(null==(n=s.controller.signal)?void 0:n.aborted)throw new J;return this._addRun(or(this,Dn,"m",Zn).call(this))}toReadableStream(){return new dt(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,e,n,r,s){const i=new ur;return i._run((()=>i._runToolAssistantStream(t,e,n,r,{...s,headers:{...null==s?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}}))),i}async _createToolAssistantStream(t,e,n,r,s){var i;const o=null==s?void 0:s.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const a={...r,stream:!0},u=await t.submitToolOutputs(e,n,a,{...s,signal:this.controller.signal});this._connected();for await(const l of u)or(this,Dn,"m",Qn).call(this,l);if(null==(i=u.controller.signal)?void 0:i.aborted)throw new J;return this._addRun(or(this,Dn,"m",Zn).call(this))}static createThreadAssistantStream(t,e,n){const r=new ur;return r._run((()=>r._threadAssistantStream(t,e,{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(t,e,n,r){const s=new ur;return s._run((()=>s._runAssistantStream(t,e,n,{...r,headers:{...null==r?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}}))),s}currentEvent(){return or(this,Xn,"f")}currentRun(){return or(this,Kn,"f")}currentMessageSnapshot(){return or(this,qn,"f")}currentRunStepSnapshot(){return or(this,Gn,"f")}async finalRunSteps(){return await this.done(),Object.values(or(this,Wn,"f"))}async finalMessages(){return await this.done(),Object.values(or(this,Fn,"f"))}async finalRun(){if(await this.done(),!or(this,Un,"f"))throw Error("Final run was not received.");return or(this,Un,"f")}async _createThreadAssistantStream(t,e,n){var r;const s=null==n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort())));const i={...e,stream:!0},o=await t.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const a of o)or(this,Dn,"m",Qn).call(this,a);if(null==(r=o.controller.signal)?void 0:r.aborted)throw new J;return this._addRun(or(this,Dn,"m",Zn).call(this))}async _createAssistantStream(t,e,n,r){var s;const i=null==r?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const o={...n,stream:!0},a=await t.create(e,o,{...r,signal:this.controller.signal});this._connected();for await(const u of a)or(this,Dn,"m",Qn).call(this,u);if(null==(s=a.controller.signal)?void 0:s.aborted)throw new J;return this._addRun(or(this,Dn,"m",Zn).call(this))}static accumulateDelta(t,e){for(const[n,r]of Object.entries(e)){if(!t.hasOwnProperty(n)){t[n]=r;continue}let e=t[n];if(null!=e)if("index"!==n&&"type"!==n){if("string"==typeof e&&"string"==typeof r)e+=r;else if("number"==typeof e&&"number"==typeof r)e+=r;else{if(!te(e)||!te(r)){if(Array.isArray(e)&&Array.isArray(r)){if(e.every((t=>"string"==typeof t||"number"==typeof t))){e.push(...r);continue}for(const t of r){if(!te(t))throw new Error(`Expected array delta entry to be an object but got: ${t}`);const n=t.index;if(null==n)throw console.error(t),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=e[n];null==r?e.push(t):e[n]=this.accumulateDelta(r,t)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${e}`)}e=this.accumulateDelta(e,r)}t[n]=e}else t[n]=r;else t[n]=r}return t}_addRun(t){return t}async _threadAssistantStream(t,e,n){return await this._createThreadAssistantStream(e,t,n)}async _runAssistantStream(t,e,n,r){return await this._createAssistantStream(e,t,n,r)}async _runToolAssistantStream(t,e,n,r,s){return await this._createToolAssistantStream(n,t,e,r,s)}}Qn=function(t){if(!this.ended)switch(ar(this,Xn,t,"f"),or(this,Dn,"m",er).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":or(this,Dn,"m",ir).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":or(this,Dn,"m",tr).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":or(this,Dn,"m",Yn).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Zn=function(){if(this.ended)throw new H("stream has ended, this shouldn't happen");if(!or(this,Un,"f"))throw Error("Final run has not been received");return or(this,Un,"f")},Yn=function(t){const[e,n]=or(this,Dn,"m",rr).call(this,t,or(this,qn,"f"));ar(this,qn,e,"f"),or(this,Fn,"f")[e.id]=e;for(const r of n){const t=e.content[r.index];"text"==(null==t?void 0:t.type)&&this._emit("textCreated",t.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,e),t.data.delta.content)for(const n of t.data.delta.content){if("text"==n.type&&n.text){let t=n.text,r=e.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",t,r.text)}if(n.index!=or(this,zn,"f")){if(or(this,Hn,"f"))switch(or(this,Hn,"f").type){case"text":this._emit("textDone",or(this,Hn,"f").text,or(this,qn,"f"));break;case"image_file":this._emit("imageFileDone",or(this,Hn,"f").image_file,or(this,qn,"f"))}ar(this,zn,n.index,"f")}ar(this,Hn,e.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==or(this,zn,"f")){const e=t.data.content[or(this,zn,"f")];if(e)switch(e.type){case"image_file":this._emit("imageFileDone",e.image_file,or(this,qn,"f"));break;case"text":this._emit("textDone",e.text,or(this,qn,"f"))}}or(this,qn,"f")&&this._emit("messageDone",t.data),ar(this,qn,void 0,"f")}},tr=function(t){const e=or(this,Dn,"m",nr).call(this,t);switch(ar(this,Gn,e,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const n=t.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==e.step_details.type)for(const t of n.step_details.tool_calls)t.index==or(this,Vn,"f")?this._emit("toolCallDelta",t,e.step_details.tool_calls[t.index]):(or(this,Jn,"f")&&this._emit("toolCallDone",or(this,Jn,"f")),ar(this,Vn,t.index,"f"),ar(this,Jn,e.step_details.tool_calls[t.index],"f"),or(this,Jn,"f")&&this._emit("toolCallCreated",or(this,Jn,"f")));this._emit("runStepDelta",t.data.delta,e);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ar(this,Gn,void 0,"f");"tool_calls"==t.data.step_details.type&&or(this,Jn,"f")&&(this._emit("toolCallDone",or(this,Jn,"f")),ar(this,Jn,void 0,"f")),this._emit("runStepDone",t.data,e)}},er=function(t){or(this,Nn,"f").push(t),this._emit("event",t)},nr=function(t){switch(t.event){case"thread.run.step.created":return or(this,Wn,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let e=or(this,Wn,"f")[t.data.id];if(!e)throw Error("Received a RunStepDelta before creation of a snapshot");let n=t.data;if(n.delta){const r=ur.accumulateDelta(e,n.delta);or(this,Wn,"f")[t.data.id]=r}return or(this,Wn,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":or(this,Wn,"f")[t.data.id]=t.data}if(or(this,Wn,"f")[t.data.id])return or(this,Wn,"f")[t.data.id];throw new Error("No snapshot available")},rr=function(t,e){let n=[];switch(t.event){case"thread.message.created":return[t.data,n];case"thread.message.delta":if(!e)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=t.data;if(r.delta.content)for(const t of r.delta.content)if(t.index in e.content){let n=e.content[t.index];e.content[t.index]=or(this,Dn,"m",sr).call(this,t,n)}else e.content[t.index]=t,n.push(t);return[e,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(e)return[e,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},sr=function(t,e){return ur.accumulateDelta(e,t)},ir=function(t){switch(ar(this,Kn,t.data,"f"),t.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ar(this,Un,t.data,"f"),or(this,Jn,"f")&&(this._emit("toolCallDone",or(this,Jn,"f")),ar(this,Jn,void 0,"f"))}};class lr extends re{create(t,e,n){return this._client.post(`/threads/${t}/messages`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}retrieve(t,e,n){return this._client.get(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}update(t,e,n,r){return this._client.post(`/threads/${t}/messages/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers}})}list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/messages`,cr,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}del(t,e,n){return this._client.delete(`/threads/${t}/messages/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}}class cr extends ne{}lr.MessagesPage=cr;class fr extends re{retrieve(t,e,n,r={},s){return Tt(r)?this.retrieve(t,e,n,{},r):this._client.get(`/threads/${t}/runs/${e}/steps/${n}`,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...null==s?void 0:s.headers}})}list(t,e,n={},r){return Tt(n)?this.list(t,e,{},n):this._client.getAPIList(`/threads/${t}/runs/${e}/steps`,hr,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers}})}}class hr extends ne{}fr.RunStepsPage=hr;let dr=class extends re{constructor(){super(...arguments),this.steps=new fr(this._client)}create(t,e,n){const{include:r,...s}=e;return this._client.post(`/threads/${t}/runs`,{query:{include:r},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers},stream:e.stream??!1})}retrieve(t,e,n){return this._client.get(`/threads/${t}/runs/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}update(t,e,n,r){return this._client.post(`/threads/${t}/runs/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers}})}list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/runs`,pr,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}cancel(t,e,n){return this._client.post(`/threads/${t}/runs/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}createAndStream(t,e,n){return ur.createAssistantStream(t,this._client.beta.threads.runs,e,n)}async poll(t,e,n){const r={...null==n?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((null==n?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(t,e,{...n,headers:{...null==n?void 0:n.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let t=5e3;if(null==n?void 0:n.pollIntervalMs)t=n.pollIntervalMs;else{const e=i.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await Ut(t);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(t,e,n){return ur.createAssistantStream(t,this._client.beta.threads.runs,e,n)}submitToolOutputs(t,e,n,r){return this._client.post(`/threads/${t}/runs/${e}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(t,e,n,r){const s=await this.submitToolOutputs(t,e,n,r);return await this.poll(t,s.id,r)}submitToolOutputsStream(t,e,n,r){return ur.createToolAssistantStream(t,e,this._client.beta.threads.runs,n,r)}};class pr extends ne{}dr.RunsPage=pr,dr.Steps=fr,dr.RunStepsPage=hr;class gr extends re{constructor(){super(...arguments),this.runs=new dr(this._client),this.messages=new lr(this._client)}create(t={},e){return Tt(t)?this.create({},t):this._client.post("/threads",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}retrieve(t,e){return this._client.get(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}update(t,e,n){return this._client.post(`/threads/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}del(t,e){return this._client.delete(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}createAndRun(t,e){return this._client.post("/threads/runs",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers},stream:t.stream??!1})}async createAndRunPoll(t,e){const n=await this.createAndRun(t,e);return await this.runs.poll(n.thread_id,n.id,e)}createAndRunStream(t,e){return ur.createThreadAssistantStream(t,this._client.beta.threads,e)}}gr.Runs=dr,gr.RunsPage=pr,gr.Messages=lr,gr.MessagesPage=cr;class mr extends re{constructor(){super(...arguments),this.realtime=new Bn(this._client),this.chat=new Tn(this._client),this.assistants=new ge(this._client),this.threads=new gr(this._client)}}mr.Realtime=Bn,mr.Assistants=ge,mr.AssistantsPage=me,mr.Threads=gr;class vr extends re{create(t,e){return this._client.post("/completions",{body:t,...e,stream:t.stream??!1})}}class _r extends re{create(t,e){const n=!!t.encoding_format;let r=n?t.encoding_format:"base64";n&&Qt("Request","User defined encoding_format:",t.encoding_format);const s=this._client.post("/embeddings",{body:{...t,encoding_format:r},...e});return n?s:(Qt("response","Decoding base64 embeddings to float32 array"),s._thenUnwrap((t=>(t&&t.data&&t.data.forEach((t=>{const e=t.embedding;t.embedding=(t=>{if("undefined"!=typeof Buffer){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let t=0;t<n;t++)r[t]=e.charCodeAt(t);return Array.from(new Float32Array(r.buffer))}})(e)})),t))))}}class yr extends re{retrieve(t,e,n,r){return this._client.get(`/evals/${t}/runs/${e}/output_items/${n}`,r)}list(t,e,n={},r){return Tt(n)?this.list(t,e,{},n):this._client.getAPIList(`/evals/${t}/runs/${e}/output_items`,wr,{query:n,...r})}}class wr extends ne{}yr.OutputItemListResponsesPage=wr;class br extends re{constructor(){super(...arguments),this.outputItems=new yr(this._client)}create(t,e,n){return this._client.post(`/evals/${t}/runs`,{body:e,...n})}retrieve(t,e,n){return this._client.get(`/evals/${t}/runs/${e}`,n)}list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/evals/${t}/runs`,xr,{query:e,...n})}del(t,e,n){return this._client.delete(`/evals/${t}/runs/${e}`,n)}cancel(t,e,n){return this._client.post(`/evals/${t}/runs/${e}`,n)}}class xr extends ne{}br.RunListResponsesPage=xr,br.OutputItems=yr,br.OutputItemListResponsesPage=wr;class Ar extends re{constructor(){super(...arguments),this.runs=new br(this._client)}create(t,e){return this._client.post("/evals",{body:t,...e})}retrieve(t,e){return this._client.get(`/evals/${t}`,e)}update(t,e,n){return this._client.post(`/evals/${t}`,{body:e,...n})}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/evals",Sr,{query:t,...e})}del(t,e){return this._client.delete(`/evals/${t}`,e)}}class Sr extends ne{}Ar.EvalListResponsesPage=Sr,Ar.Runs=br,Ar.RunListResponsesPage=xr;let Rr=class extends re{create(t,e){return this._client.post("/files",xt({body:t,...e}))}retrieve(t,e){return this._client.get(`/files/${t}`,e)}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/files",Ir,{query:t,...e})}del(t,e){return this._client.delete(`/files/${t}`,e)}content(t,e){return this._client.get(`/files/${t}/content`,{...e,headers:{Accept:"application/binary",...null==e?void 0:e.headers},__binaryResponse:!0})}retrieveContent(t,e){return this._client.get(`/files/${t}/content`,e)}async waitForProcessing(t,{pollInterval:e=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let i=await this.retrieve(t);for(;!i.status||!r.has(i.status);)if(await Ut(e),i=await this.retrieve(t),Date.now()-s>n)throw new K({message:`Giving up on waiting for file ${t} to finish processing after ${n} milliseconds.`});return i}};class Ir extends ne{}Rr.FileObjectsPage=Ir;class Er extends re{create(t,e,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${t}/permissions`,kr,{body:e,method:"post",...n})}retrieve(t,e={},n){return Tt(e)?this.retrieve(t,{},e):this._client.get(`/fine_tuning/checkpoints/${t}/permissions`,{query:e,...n})}del(t,e){return this._client.delete(`/fine_tuning/checkpoints/${t}/permissions`,e)}}class kr extends ee{}Er.PermissionCreateResponsesPage=kr;let $r=class extends re{constructor(){super(...arguments),this.permissions=new Er(this._client)}};$r.Permissions=Er,$r.PermissionCreateResponsesPage=kr;class Or extends re{list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,Pr,{query:e,...n})}}class Pr extends ne{}Or.FineTuningJobCheckpointsPage=Pr;class Cr extends re{constructor(){super(...arguments),this.checkpoints=new Or(this._client)}create(t,e){return this._client.post("/fine_tuning/jobs",{body:t,...e})}retrieve(t,e){return this._client.get(`/fine_tuning/jobs/${t}`,e)}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",jr,{query:t,...e})}cancel(t,e){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,e)}listEvents(t,e={},n){return Tt(e)?this.listEvents(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,Tr,{query:e,...n})}}class jr extends ne{}class Tr extends ne{}Cr.FineTuningJobsPage=jr,Cr.FineTuningJobEventsPage=Tr,Cr.Checkpoints=Or,Cr.FineTuningJobCheckpointsPage=Pr;class Mr extends re{constructor(){super(...arguments),this.jobs=new Cr(this._client),this.checkpoints=new $r(this._client)}}Mr.Jobs=Cr,Mr.FineTuningJobsPage=jr,Mr.FineTuningJobEventsPage=Tr,Mr.Checkpoints=$r;class Lr extends re{createVariation(t,e){return this._client.post("/images/variations",xt({body:t,...e}))}edit(t,e){return this._client.post("/images/edits",xt({body:t,...e}))}generate(t,e){return this._client.post("/images/generations",{body:t,...e})}}class Br extends re{retrieve(t,e){return this._client.get(`/models/${t}`,e)}list(t){return this._client.getAPIList("/models",Dr,t)}del(t,e){return this._client.delete(`/models/${t}`,e)}}class Dr extends ee{}Br.ModelsPage=Dr;class Nr extends re{create(t,e){return this._client.post("/moderations",{body:t,...e})}}function Wr(t,e){return e&&function(t){var e;if(Be(null==(e=t.text)?void 0:e.format))return!0;return!1}(e)?Fr(t,e):{...t,output_parsed:null,output:t.output.map((t=>"function_call"===t.type?{...t,parsed_arguments:null}:"message"===t.type?{...t,content:t.content.map((t=>({...t,parsed:null})))}:t))}}function Fr(t,e){const n=t.output.map((t=>{if("function_call"===t.type)return{...t,parsed_arguments:Ur(e,t)};if("message"===t.type){const n=t.content.map((t=>"output_text"===t.type?{...t,parsed:qr(e,t.text)}:t));return{...t,content:n}}return t})),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||zr(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const t of r.output)if("message"===t.type)for(const e of t.content)if("output_text"===e.type&&null!==e.parsed)return e.parsed;return null}}),r}function qr(t,e){var n,r,s,i;if("json_schema"!==(null==(r=null==(n=t.text)?void 0:n.format)?void 0:r.type))return null;if("$parseRaw"in(null==(s=t.text)?void 0:s.format)){return(null==(i=t.text)?void 0:i.format).$parseRaw(e)}return JSON.parse(e)}function Ur(t,e){const n=(r=t.tools??[],s=e.name,r.find((t=>"function"===t.type&&t.name===s)));var r,s,i;return{...e,...e,parsed_arguments:(i=n,"auto-parseable-tool"===(null==i?void 0:i.$brand)?n.$parseRaw(e.arguments):(null==n?void 0:n.strict)?JSON.parse(e.arguments):null)}}function zr(t){const e=[];for(const n of t.output)if("message"===n.type)for(const t of n.content)"output_text"===t.type&&e.push(t.text);t.output_text=e.join("")}class Hr extends re{list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/responses/${t}/input_items`,ss,{query:e,...n})}}var Vr,Jr,Xr,Kr,Gr,Qr,Zr,Yr,ts=function(t,e,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(t,n):s?s.value=n:e.set(t,n),n},es=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class ns extends Le{constructor(t){super(),Vr.add(this),Jr.set(this,void 0),Xr.set(this,void 0),Kr.set(this,void 0),ts(this,Jr,t,"f")}static createResponse(t,e,n){const r=new ns(e);return r._run((()=>r._createResponse(t,e,{...n,headers:{...null==n?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createResponse(t,e,n){var r;const s=null==n?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort()))),es(this,Vr,"m",Gr).call(this);const i=await t.responses.create({...e,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)es(this,Vr,"m",Qr).call(this,o);if(null==(r=i.controller.signal)?void 0:r.aborted)throw new J;return es(this,Vr,"m",Zr).call(this)}[(Jr=new WeakMap,Xr=new WeakMap,Kr=new WeakMap,Vr=new WeakSet,Gr=function(){this.ended||ts(this,Xr,void 0,"f")},Qr=function(t){if(this.ended)return;const e=es(this,Vr,"m",Yr).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const n=e.output[t.output_index];if(!n)throw new H(`missing output at index ${t.output_index}`);if("message"===n.type){const e=n.content[t.content_index];if(!e)throw new H(`missing content at index ${t.content_index}`);if("output_text"!==e.type)throw new H(`expected content to be 'output_text', got ${e.type}`);this._emit("response.output_text.delta",{...t,snapshot:e.text})}break}case"response.function_call_arguments.delta":{const n=e.output[t.output_index];if(!n)throw new H(`missing output at index ${t.output_index}`);"function_call"===n.type&&this._emit("response.function_call_arguments.delta",{...t,snapshot:n.arguments});break}default:this._emit(t.type,t)}},Zr=function(){if(this.ended)throw new H("stream has ended, this shouldn't happen");const t=es(this,Xr,"f");if(!t)throw new H("request ended without sending any events");ts(this,Xr,void 0,"f");const e=function(t,e){return Wr(t,e)}(t,es(this,Jr,"f"));return ts(this,Kr,e,"f"),e},Yr=function(t){let e=es(this,Xr,"f");if(!e){if("response.created"!==t.type)throw new H(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return e=ts(this,Xr,t.response,"f"),e}switch(t.type){case"response.output_item.added":e.output.push(t.item);break;case"response.content_part.added":{const n=e.output[t.output_index];if(!n)throw new H(`missing output at index ${t.output_index}`);"message"===n.type&&n.content.push(t.part);break}case"response.output_text.delta":{const n=e.output[t.output_index];if(!n)throw new H(`missing output at index ${t.output_index}`);if("message"===n.type){const e=n.content[t.content_index];if(!e)throw new H(`missing content at index ${t.content_index}`);if("output_text"!==e.type)throw new H(`expected content to be 'output_text', got ${e.type}`);e.text+=t.delta}break}case"response.function_call_arguments.delta":{const n=e.output[t.output_index];if(!n)throw new H(`missing output at index ${t.output_index}`);"function_call"===n.type&&(n.arguments+=t.delta);break}case"response.completed":ts(this,Xr,t.response,"f")}return e},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("event",(n=>{const r=e.shift();r?r.resolve(n):t.push(n)})),this.on("end",(()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),this.on("error",(t=>{n=!0;for(const n of e)n.reject(t);e.length=0})),{next:async()=>{if(!t.length)return n?{value:void 0,done:!0}:new Promise(((t,n)=>e.push({resolve:t,reject:n}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0}));return{value:t.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=es(this,Kr,"f");if(!t)throw new H("stream ended without producing a ChatCompletion");return t}}class rs extends re{constructor(){super(...arguments),this.inputItems=new Hr(this._client)}create(t,e){return this._client.post("/responses",{body:t,...e,stream:t.stream??!1})._thenUnwrap((t=>("object"in t&&"response"===t.object&&zr(t),t)))}retrieve(t,e={},n){return Tt(e)?this.retrieve(t,{},e):this._client.get(`/responses/${t}`,{query:e,...n})}del(t,e){return this._client.delete(`/responses/${t}`,{...e,headers:{Accept:"*/*",...null==e?void 0:e.headers}})}parse(t,e){return this._client.responses.create(t,e)._thenUnwrap((e=>Fr(e,t)))}stream(t,e){return ns.createResponse(this._client,t,e)}}class ss extends ne{}rs.InputItems=Hr;class is extends re{create(t,e,n){return this._client.post(`/uploads/${t}/parts`,xt({body:e,...n}))}}class os extends re{constructor(){super(...arguments),this.parts=new is(this._client)}create(t,e){return this._client.post("/uploads",{body:t,...e})}cancel(t,e){return this._client.post(`/uploads/${t}/cancel`,e)}complete(t,e,n){return this._client.post(`/uploads/${t}/complete`,{body:e,...n})}}os.Parts=is;class as extends re{create(t,e,n){return this._client.post(`/vector_stores/${t}/files`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}retrieve(t,e,n){return this._client.get(`/vector_stores/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}update(t,e,n,r){return this._client.post(`/vector_stores/${t}/files/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers}})}list(t,e={},n){return Tt(e)?this.list(t,{},e):this._client.getAPIList(`/vector_stores/${t}/files`,us,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}del(t,e,n){return this._client.delete(`/vector_stores/${t}/files/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}async poll(t,e,n){const r={...null==n?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((null==n?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(t,e,{...n,headers:r}).withResponse(),i=s.data;switch(i.status){case"in_progress":let t=5e3;if(null==n?void 0:n.pollIntervalMs)t=n.pollIntervalMs;else{const e=s.response.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await Ut(t);break;case"failed":case"completed":return i}}}async upload(t,e,n){const r=await this._client.files.create({file:e,purpose:"assistants"},n);return this.create(t,{file_id:r.id},n)}async uploadAndPoll(t,e,n){const r=await this.upload(t,e,n);return await this.poll(t,r.id,n)}content(t,e,n){return this._client.getAPIList(`/vector_stores/${t}/files/${e}/content`,ls,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}}class us extends ne{}class ls extends ee{}as.VectorStoreFilesPage=us,as.FileContentResponsesPage=ls;class cs extends re{create(t,e,n){return this._client.post(`/vector_stores/${t}/file_batches`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}retrieve(t,e,n){return this._client.get(`/vector_stores/${t}/file_batches/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}cancel(t,e,n){return this._client.post(`/vector_stores/${t}/file_batches/${e}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}async createAndPoll(t,e,n){const r=await this.create(t,e);return await this.poll(t,r.id,n)}listFiles(t,e,n={},r){return Tt(n)?this.listFiles(t,e,{},n):this._client.getAPIList(`/vector_stores/${t}/file_batches/${e}/files`,us,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...null==r?void 0:r.headers}})}async poll(t,e,n){const r={...null==n?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for((null==n?void 0:n.pollIntervalMs)&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(t,e,{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let t=5e3;if(null==n?void 0:n.pollIntervalMs)t=n.pollIntervalMs;else{const e=i.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await Ut(t);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(t,{files:e,fileIds:n=[]},r){if(null==e||0==e.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=(null==r?void 0:r.maxConcurrency)??5,i=Math.min(s,e.length),o=this._client,a=e.values(),u=[...n];const l=Array(i).fill(a).map((async function(t){for(let e of t){const t=await o.files.create({file:e,purpose:"assistants"},r);u.push(t.id)}}));return await(async t=>{const e=await Promise.allSettled(t),n=e.filter((t=>"rejected"===t.status));if(n.length){for(const t of n)console.error(t.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)"fulfilled"===s.status&&r.push(s.value);return r})(l),await this.createAndPoll(t,{file_ids:u})}}class fs extends re{constructor(){super(...arguments),this.files=new as(this._client),this.fileBatches=new cs(this._client)}create(t,e){return this._client.post("/vector_stores",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}retrieve(t,e){return this._client.get(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}update(t,e,n){return this._client.post(`/vector_stores/${t}`,{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}list(t={},e){return Tt(t)?this.list({},t):this._client.getAPIList("/vector_stores",hs,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}del(t,e){return this._client.delete(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...null==e?void 0:e.headers}})}search(t,e,n){return this._client.getAPIList(`/vector_stores/${t}/search`,ds,{body:e,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...null==n?void 0:n.headers}})}}class hs extends ne{}class ds extends ee{}var ps;fs.VectorStoresPage=hs,fs.VectorStoreSearchResponsesPage=ds,fs.Files=as,fs.VectorStoreFilesPage=us,fs.FileContentResponsesPage=ls,fs.FileBatches=cs;class gs extends class{constructor({baseURL:t,maxRetries:e=2,timeout:n=6e5,httpAgent:r,fetch:s}){this.baseURL=t,this.maxRetries=zt("maxRetries",e),this.timeout=zt("timeout",n),this.httpAgent=r,this.fetch=s??T}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Nt(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${Zt()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&vt(null==n?void 0:n.body)?new DataView(await n.body.arrayBuffer()):(null==n?void 0:n.body)instanceof DataView?n.body:(null==n?void 0:n.body)instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(null==n?void 0:n.body)?new DataView(n.body.buffer):null==n?void 0:n.body;return{method:t,path:e,...n,body:r}})))}getAPIList(t,e,n){return this.requestAPIList(e,{method:"get",path:t,...n})}calculateContentLength(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(t).length.toString()}}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:e=0}={}){var n;const r={...t},{method:s,path:i,query:o,headers:a={}}=r,u=ArrayBuffer.isView(r.body)||r.__binaryRequest&&"string"==typeof r.body?r.body:bt(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,l=this.calculateContentLength(u),c=this.buildURL(i,o);"timeout"in r&&zt("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const f=r.httpAgent??this.httpAgent??N(c),h=r.timeout+1e3;"number"==typeof(null==(n=null==f?void 0:f.options)?void 0:n.timeout)&&h>(f.options.timeout??0)&&(f.options.timeout=h),this.idempotencyHeader&&"get"!==s&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=t.idempotencyKey);return{req:{method:s,...u&&{body:u},headers:this.buildHeaders({options:r,headers:a,contentLength:l,retryCount:e}),...f&&{agent:f},signal:r.signal??null},url:c,timeout:r.timeout}}buildHeaders({options:t,headers:e,contentLength:n,retryCount:r}){const s={};n&&(s["content-length"]=n);const i=this.defaultHeaders(t);return Kt(s,i),Kt(s,e),bt(t.body)&&"node"!==j&&delete s["content-type"],void 0===Yt(i,"x-stainless-retry-count")&&void 0===Yt(e,"x-stainless-retry-count")&&(s["x-stainless-retry-count"]=String(r)),void 0===Yt(i,"x-stainless-timeout")&&void 0===Yt(e,"x-stainless-timeout")&&t.timeout&&(s["x-stainless-timeout"]=String(Math.trunc(t.timeout/1e3))),this.validateHeaders(s,e),s}async prepareOptions(t){}async prepareRequest(t,{url:e,options:n}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,n,r){return V.generate(t,e,n,r)}request(t,e=null){return new $t(this.makeRequest(t,e))}async makeRequest(t,e){var n,r;const s=await t,i=s.maxRetries??this.maxRetries;null==e&&(e=i),await this.prepareOptions(s);const{req:o,url:a,timeout:u}=this.buildRequest(s,{retryCount:i-e});if(await this.prepareRequest(o,{url:a,options:s}),Qt("request",a,s,o.headers),null==(n=s.signal)?void 0:n.aborted)throw new J;const l=new AbortController,c=await this.fetchWithTimeout(a,o,u,l).catch(Ht);if(c instanceof Error){if(null==(r=s.signal)?void 0:r.aborted)throw new J;if(e)return this.retryRequest(s,e);if("AbortError"===c.name)throw new K;throw new X({cause:c})}const f=Ct(c.headers);if(!c.ok){if(e&&this.shouldRetry(c)){return Qt(`response (error; ${`retrying, ${e} attempts remaining`})`,c.status,a,f),this.retryRequest(s,e,f)}const t=await c.text().catch((t=>Ht(t).message)),n=Wt(t),r=n?void 0:t;Qt(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,f,r);throw this.makeStatusError(c.status,n,r,f)}return{response:c,options:s,controller:l}}requestAPIList(t,e){const n=this.makeRequest(e,null);return new Pt(this,n,t)}buildURL(t,e){const n=qt(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),r=this.defaultQuery();return Jt(r)||(e={...r,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(n.search=this.stringifyQuery(e)),n.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new H(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,n,r){const{signal:s,...i}=e||{};s&&s.addEventListener("abort",(()=>r.abort()));const o=setTimeout((()=>r.abort()),n),a={signal:r.signal,...i};return a.method&&(a.method=a.method.toUpperCase()),this.fetch.call(void 0,t,a).finally((()=>{clearTimeout(o)}))}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||(409===t.status||(429===t.status||t.status>=500)))}async retryRequest(t,e,n){let r;const s=null==n?void 0:n["retry-after-ms"];if(s){const t=parseFloat(s);Number.isNaN(t)||(r=t)}const i=null==n?void 0:n["retry-after"];if(i&&!r){const t=parseFloat(i);r=Number.isNaN(t)?Date.parse(i)-Date.now():1e3*t}if(!(r&&0<=r&&r<6e4)){const n=t.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(e,n)}return await Ut(r),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const n=e-t;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS 4.95.1`}}{constructor({baseURL:t=Vt("OPENAI_BASE_URL"),apiKey:e=Vt("OPENAI_API_KEY"),organization:n=Vt("OPENAI_ORG_ID")??null,project:r=Vt("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===e)throw new H("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:e,organization:n,project:r,...s,baseURL:t||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new H("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new vr(this),this.chat=new ue(this),this.embeddings=new _r(this),this.files=new Rr(this),this.images=new Lr(this),this.audio=new he(this),this.moderations=new Nr(this),this.models=new Br(this),this.fineTuning=new Mr(this),this.vectorStores=new fs(this),this.beta=new mr(this),this.batches=new de(this),this.uploads=new os(this),this.responses=new rs(this),this.evals=new Ar(this),this._options=i,this.apiKey=e,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return C(t,{arrayFormat:"brackets"})}}ps=gs,gs.OpenAI=ps,gs.DEFAULT_TIMEOUT=6e5,gs.OpenAIError=H,gs.APIError=V,gs.APIConnectionError=X,gs.APIConnectionTimeoutError=K,gs.APIUserAbortError=J,gs.NotFoundError=Y,gs.ConflictError=tt,gs.RateLimitError=nt,gs.BadRequestError=G,gs.AuthenticationError=Q,gs.InternalServerError=rt,gs.PermissionDeniedError=Z,gs.UnprocessableEntityError=et,gs.toFile=_t,gs.fileFromPath=W,gs.Completions=vr,gs.Chat=ue,gs.ChatCompletionsPage=oe,gs.Embeddings=_r,gs.Files=Rr,gs.FileObjectsPage=Ir,gs.Images=Lr,gs.Audio=he,gs.Moderations=Nr,gs.Models=Br,gs.ModelsPage=Dr,gs.FineTuning=Mr,gs.VectorStores=fs,gs.VectorStoresPage=hs,gs.VectorStoreSearchResponsesPage=ds,gs.Beta=mr,gs.Batches=de,gs.BatchesPage=pe,gs.Uploads=os,gs.Responses=rs,gs.Evals=Ar,gs.EvalListResponsesPage=Sr;var ms,vs,_s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ys={exports:{}};ms=ys,vs=ys.exports,function(){var t,e="Expected a function",n="__lodash_hash_undefined__",r="__lodash_placeholder__",s=16,i=32,o=64,a=128,u=256,l=1/0,c=9007199254740991,f=NaN,h=4294967295,d=[["ary",a],["bind",1],["bindKey",2],["curry",8],["curryRight",s],["flip",512],["partial",i],["partialRight",o],["rearg",u]],p="[object Arguments]",g="[object Array]",m="[object Boolean]",v="[object Date]",_="[object Error]",y="[object Function]",w="[object GeneratorFunction]",b="[object Map]",x="[object Number]",A="[object Object]",S="[object Promise]",R="[object RegExp]",I="[object Set]",E="[object String]",k="[object Symbol]",$="[object WeakMap]",O="[object ArrayBuffer]",P="[object DataView]",C="[object Float32Array]",j="[object Float64Array]",T="[object Int8Array]",M="[object Int16Array]",L="[object Int32Array]",B="[object Uint8Array]",D="[object Uint8ClampedArray]",N="[object Uint16Array]",W="[object Uint32Array]",F=/\b__p \+= '';/g,q=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,z=/&(?:amp|lt|gt|quot|#39);/g,H=/[&<>"']/g,V=RegExp(z.source),J=RegExp(H.source),X=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,G=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/,Y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tt=/[\\^$.*+?()[\]{}|]/g,et=RegExp(tt.source),nt=/^\s+/,rt=/\s/,st=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,it=/\{\n\/\* \[wrapped with (.+)\] \*/,ot=/,? & /,at=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ut=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,ct=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ft=/\w*$/,ht=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,pt=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,mt=/^(?:0|[1-9]\d*)$/,vt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,yt=/['\n\r\u2028\u2029\\]/g,wt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",bt="\\u2700-\\u27bf",xt="a-z\\xdf-\\xf6\\xf8-\\xff",At="A-Z\\xc0-\\xd6\\xd8-\\xde",St="\\ufe0e\\ufe0f",Rt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",It="['’]",Et="[\\ud800-\\udfff]",kt="["+Rt+"]",$t="["+wt+"]",Ot="\\d+",Pt="[\\u2700-\\u27bf]",Ct="["+xt+"]",jt="[^\\ud800-\\udfff"+Rt+Ot+bt+xt+At+"]",Tt="\\ud83c[\\udffb-\\udfff]",Mt="[^\\ud800-\\udfff]",Lt="(?:\\ud83c[\\udde6-\\uddff]){2}",Bt="[\\ud800-\\udbff][\\udc00-\\udfff]",Dt="["+At+"]",Nt="(?:"+Ct+"|"+jt+")",Wt="(?:"+Dt+"|"+jt+")",Ft="(?:['’](?:d|ll|m|re|s|t|ve))?",qt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ut="(?:"+$t+"|"+Tt+")?",zt="[\\ufe0e\\ufe0f]?",Ht=zt+Ut+"(?:\\u200d(?:"+[Mt,Lt,Bt].join("|")+")"+zt+Ut+")*",Vt="(?:"+[Pt,Lt,Bt].join("|")+")"+Ht,Jt="(?:"+[Mt+$t+"?",$t,Lt,Bt,Et].join("|")+")",Xt=RegExp(It,"g"),Kt=RegExp($t,"g"),Gt=RegExp(Tt+"(?="+Tt+")|"+Jt+Ht,"g"),Qt=RegExp([Dt+"?"+Ct+"+"+Ft+"(?="+[kt,Dt,"$"].join("|")+")",Wt+"+"+qt+"(?="+[kt,Dt+Nt,"$"].join("|")+")",Dt+"?"+Nt+"+"+Ft,Dt+"+"+qt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ot,Vt].join("|"),"g"),Zt=RegExp("[\\u200d\\ud800-\\udfff"+wt+St+"]"),Yt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,te=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ee=-1,ne={};ne[C]=ne[j]=ne[T]=ne[M]=ne[L]=ne[B]=ne[D]=ne[N]=ne[W]=!0,ne[p]=ne[g]=ne[O]=ne[m]=ne[P]=ne[v]=ne[_]=ne[y]=ne[b]=ne[x]=ne[A]=ne[R]=ne[I]=ne[E]=ne[$]=!1;var re={};re[p]=re[g]=re[O]=re[P]=re[m]=re[v]=re[C]=re[j]=re[T]=re[M]=re[L]=re[b]=re[x]=re[A]=re[R]=re[I]=re[E]=re[k]=re[B]=re[D]=re[N]=re[W]=!0,re[_]=re[y]=re[$]=!1;var se={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ie=parseFloat,oe=parseInt,ae="object"==typeof _s&&_s&&_s.Object===Object&&_s,ue="object"==typeof self&&self&&self.Object===Object&&self,le=ae||ue||Function("return this")(),ce=vs&&!vs.nodeType&&vs,fe=ce&&ms&&!ms.nodeType&&ms,he=fe&&fe.exports===ce,de=he&&ae.process,pe=function(){try{var t=fe&&fe.require&&fe.require("util").types;return t||de&&de.binding&&de.binding("util")}catch(e){}}(),ge=pe&&pe.isArrayBuffer,me=pe&&pe.isDate,ve=pe&&pe.isMap,_e=pe&&pe.isRegExp,ye=pe&&pe.isSet,we=pe&&pe.isTypedArray;function be(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function xe(t,e,n,r){for(var s=-1,i=null==t?0:t.length;++s<i;){var o=t[s];e(r,o,n(o),t)}return r}function Ae(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Se(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Re(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Ie(t,e){for(var n=-1,r=null==t?0:t.length,s=0,i=[];++n<r;){var o=t[n];e(o,n,t)&&(i[s++]=o)}return i}function Ee(t,e){return!(null==t||!t.length)&&Be(t,e,0)>-1}function ke(t,e,n){for(var r=-1,s=null==t?0:t.length;++r<s;)if(n(e,t[r]))return!0;return!1}function $e(t,e){for(var n=-1,r=null==t?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}function Oe(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t}function Pe(t,e,n,r){var s=-1,i=null==t?0:t.length;for(r&&i&&(n=t[++s]);++s<i;)n=e(n,t[s],s,t);return n}function Ce(t,e,n,r){var s=null==t?0:t.length;for(r&&s&&(n=t[--s]);s--;)n=e(n,t[s],s,t);return n}function je(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Te=Fe("length");function Me(t,e,n){var r;return n(t,(function(t,n,s){if(e(t,n,s))return r=n,!1})),r}function Le(t,e,n,r){for(var s=t.length,i=n+(r?1:-1);r?i--:++i<s;)if(e(t[i],i,t))return i;return-1}function Be(t,e,n){return e==e?function(t,e,n){for(var r=n-1,s=t.length;++r<s;)if(t[r]===e)return r;return-1}(t,e,n):Le(t,Ne,n)}function De(t,e,n,r){for(var s=n-1,i=t.length;++s<i;)if(r(t[s],e))return s;return-1}function Ne(t){return t!=t}function We(t,e){var n=null==t?0:t.length;return n?ze(t,e)/n:f}function Fe(e){return function(n){return null==n?t:n[e]}}function qe(e){return function(n){return null==e?t:e[n]}}function Ue(t,e,n,r,s){return s(t,(function(t,s,i){n=r?(r=!1,t):e(n,t,s,i)})),n}function ze(e,n){for(var r,s=-1,i=e.length;++s<i;){var o=n(e[s]);o!==t&&(r=r===t?o:r+o)}return r}function He(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ve(t){return t?t.slice(0,cn(t)+1).replace(nt,""):t}function Je(t){return function(e){return t(e)}}function Xe(t,e){return $e(e,(function(e){return t[e]}))}function Ke(t,e){return t.has(e)}function Ge(t,e){for(var n=-1,r=t.length;++n<r&&Be(e,t[n],0)>-1;);return n}function Qe(t,e){for(var n=t.length;n--&&Be(e,t[n],0)>-1;);return n}function Ze(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Ye=qe({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),tn=qe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function en(t){return"\\"+se[t]}function nn(t){return Zt.test(t)}function rn(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function sn(t,e){return function(n){return t(e(n))}}function on(t,e){for(var n=-1,s=t.length,i=0,o=[];++n<s;){var a=t[n];a!==e&&a!==r||(t[n]=r,o[i++]=n)}return o}function an(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function un(t){return nn(t)?function(t){for(var e=Gt.lastIndex=0;Gt.test(t);)++e;return e}(t):Te(t)}function ln(t){return nn(t)?function(t){return t.match(Gt)||[]}(t):function(t){return t.split("")}(t)}function cn(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var fn=qe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),hn=function rt(wt){var bt,xt=(wt=null==wt?le:hn.defaults(le.Object(),wt,hn.pick(le,te))).Array,At=wt.Date,St=wt.Error,Rt=wt.Function,It=wt.Math,Et=wt.Object,kt=wt.RegExp,$t=wt.String,Ot=wt.TypeError,Pt=xt.prototype,Ct=Rt.prototype,jt=Et.prototype,Tt=wt["__core-js_shared__"],Mt=Ct.toString,Lt=jt.hasOwnProperty,Bt=0,Dt=(bt=/[^.]+$/.exec(Tt&&Tt.keys&&Tt.keys.IE_PROTO||""))?"Symbol(src)_1."+bt:"",Nt=jt.toString,Wt=Mt.call(Et),Ft=le._,qt=kt("^"+Mt.call(Lt).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ut=he?wt.Buffer:t,zt=wt.Symbol,Ht=wt.Uint8Array,Vt=Ut?Ut.allocUnsafe:t,Jt=sn(Et.getPrototypeOf,Et),Gt=Et.create,Zt=jt.propertyIsEnumerable,se=Pt.splice,ae=zt?zt.isConcatSpreadable:t,ue=zt?zt.iterator:t,ce=zt?zt.toStringTag:t,fe=function(){try{var t=hi(Et,"defineProperty");return t({},"",{}),t}catch(e){}}(),de=wt.clearTimeout!==le.clearTimeout&&wt.clearTimeout,pe=At&&At.now!==le.Date.now&&At.now,Te=wt.setTimeout!==le.setTimeout&&wt.setTimeout,qe=It.ceil,dn=It.floor,pn=Et.getOwnPropertySymbols,gn=Ut?Ut.isBuffer:t,mn=wt.isFinite,vn=Pt.join,_n=sn(Et.keys,Et),yn=It.max,wn=It.min,bn=At.now,xn=wt.parseInt,An=It.random,Sn=Pt.reverse,Rn=hi(wt,"DataView"),In=hi(wt,"Map"),En=hi(wt,"Promise"),kn=hi(wt,"Set"),$n=hi(wt,"WeakMap"),On=hi(Et,"create"),Pn=$n&&new $n,Cn={},jn=qi(Rn),Tn=qi(In),Mn=qi(En),Ln=qi(kn),Bn=qi($n),Dn=zt?zt.prototype:t,Nn=Dn?Dn.valueOf:t,Wn=Dn?Dn.toString:t;function Fn(t){if(oa(t)&&!Ko(t)&&!(t instanceof Hn)){if(t instanceof zn)return t;if(Lt.call(t,"__wrapped__"))return Ui(t)}return new zn(t)}var qn=function(){function e(){}return function(n){if(!ia(n))return{};if(Gt)return Gt(n);e.prototype=n;var r=new e;return e.prototype=t,r}}();function Un(){}function zn(e,n){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}function Hn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=h,this.__views__=[]}function Vn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Jn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Xn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Kn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Xn;++e<n;)this.add(t[e])}function Gn(t){var e=this.__data__=new Jn(t);this.size=e.size}function Qn(t,e){var n=Ko(t),r=!n&&Xo(t),s=!n&&!r&&Yo(t),i=!n&&!r&&!s&&pa(t),o=n||r||s||i,a=o?He(t.length,$t):[],u=a.length;for(var l in t)!e&&!Lt.call(t,l)||o&&("length"==l||s&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||yi(l,u))||a.push(l);return a}function Zn(e){var n=e.length;return n?e[Kr(0,n-1)]:t}function Yn(t,e){return Li(Os(t),ur(e,0,t.length))}function tr(t){return Li(Os(t))}function er(e,n,r){(r!==t&&!Ho(e[n],r)||r===t&&!(n in e))&&or(e,n,r)}function nr(e,n,r){var s=e[n];Lt.call(e,n)&&Ho(s,r)&&(r!==t||n in e)||or(e,n,r)}function rr(t,e){for(var n=t.length;n--;)if(Ho(t[n][0],e))return n;return-1}function sr(t,e,n,r){return dr(t,(function(t,s,i){e(r,t,n(t),i)})),r}function ir(t,e){return t&&Ps(e,La(e),t)}function or(t,e,n){"__proto__"==e&&fe?fe(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ar(e,n){for(var r=-1,s=n.length,i=xt(s),o=null==e;++r<s;)i[r]=o?t:Pa(e,n[r]);return i}function ur(e,n,r){return e==e&&(r!==t&&(e=e<=r?e:r),n!==t&&(e=e>=n?e:n)),e}function lr(e,n,r,s,i,o){var a,u=1&n,l=2&n,c=4&n;if(r&&(a=i?r(e,s,i,o):r(e)),a!==t)return a;if(!ia(e))return e;var f=Ko(e);if(f){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Lt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!u)return Os(e,a)}else{var h=gi(e),d=h==y||h==w;if(Yo(e))return Ss(e,u);if(h==A||h==p||d&&!i){if(a=l||d?{}:vi(e),!u)return l?function(t,e){return Ps(t,pi(t),e)}(e,function(t,e){return t&&Ps(e,Ba(e),t)}(a,e)):function(t,e){return Ps(t,di(t),e)}(e,ir(a,e))}else{if(!re[h])return i?e:{};a=function(t,e,n){var r,s=t.constructor;switch(e){case O:return Rs(t);case m:case v:return new s(+t);case P:return function(t,e){var n=e?Rs(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case C:case j:case T:case M:case L:case B:case D:case N:case W:return Is(t,n);case b:return new s;case x:case E:return new s(t);case R:return function(t){var e=new t.constructor(t.source,ft.exec(t));return e.lastIndex=t.lastIndex,e}(t);case I:return new s;case k:return r=t,Nn?Et(Nn.call(r)):{}}}(e,h,u)}}o||(o=new Gn);var g=o.get(e);if(g)return g;o.set(e,a),fa(e)?e.forEach((function(t){a.add(lr(t,n,r,t,e,o))})):aa(e)&&e.forEach((function(t,s){a.set(s,lr(t,n,r,s,e,o))}));var _=f?t:(c?l?ii:si:l?Ba:La)(e);return Ae(_||e,(function(t,s){_&&(t=e[s=t]),nr(a,s,lr(t,n,r,s,e,o))})),a}function cr(e,n,r){var s=r.length;if(null==e)return!s;for(e=Et(e);s--;){var i=r[s],o=n[i],a=e[i];if(a===t&&!(i in e)||!o(a))return!1}return!0}function fr(n,r,s){if("function"!=typeof n)throw new Ot(e);return Ci((function(){n.apply(t,s)}),r)}function hr(t,e,n,r){var s=-1,i=Ee,o=!0,a=t.length,u=[],l=e.length;if(!a)return u;n&&(e=$e(e,Je(n))),r?(i=ke,o=!1):e.length>=200&&(i=Ke,o=!1,e=new Kn(e));t:for(;++s<a;){var c=t[s],f=null==n?c:n(c);if(c=r||0!==c?c:0,o&&f==f){for(var h=l;h--;)if(e[h]===f)continue t;u.push(c)}else i(e,f,r)||u.push(c)}return u}Fn.templateSettings={escape:X,evaluate:K,interpolate:G,variable:"",imports:{_:Fn}},Fn.prototype=Un.prototype,Fn.prototype.constructor=Fn,zn.prototype=qn(Un.prototype),zn.prototype.constructor=zn,Hn.prototype=qn(Un.prototype),Hn.prototype.constructor=Hn,Vn.prototype.clear=function(){this.__data__=On?On(null):{},this.size=0},Vn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Vn.prototype.get=function(e){var r=this.__data__;if(On){var s=r[e];return s===n?t:s}return Lt.call(r,e)?r[e]:t},Vn.prototype.has=function(e){var n=this.__data__;return On?n[e]!==t:Lt.call(n,e)},Vn.prototype.set=function(e,r){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=On&&r===t?n:r,this},Jn.prototype.clear=function(){this.__data__=[],this.size=0},Jn.prototype.delete=function(t){var e=this.__data__,n=rr(e,t);return!(n<0||(n==e.length-1?e.pop():se.call(e,n,1),--this.size,0))},Jn.prototype.get=function(e){var n=this.__data__,r=rr(n,e);return r<0?t:n[r][1]},Jn.prototype.has=function(t){return rr(this.__data__,t)>-1},Jn.prototype.set=function(t,e){var n=this.__data__,r=rr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Xn.prototype.clear=function(){this.size=0,this.__data__={hash:new Vn,map:new(In||Jn),string:new Vn}},Xn.prototype.delete=function(t){var e=ci(this,t).delete(t);return this.size-=e?1:0,e},Xn.prototype.get=function(t){return ci(this,t).get(t)},Xn.prototype.has=function(t){return ci(this,t).has(t)},Xn.prototype.set=function(t,e){var n=ci(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Kn.prototype.add=Kn.prototype.push=function(t){return this.__data__.set(t,n),this},Kn.prototype.has=function(t){return this.__data__.has(t)},Gn.prototype.clear=function(){this.__data__=new Jn,this.size=0},Gn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Gn.prototype.get=function(t){return this.__data__.get(t)},Gn.prototype.has=function(t){return this.__data__.has(t)},Gn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Jn){var r=n.__data__;if(!In||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Xn(r)}return n.set(t,e),this.size=n.size,this};var dr=Ts(br),pr=Ts(xr,!0);function gr(t,e){var n=!0;return dr(t,(function(t,r,s){return n=!!e(t,r,s)})),n}function mr(e,n,r){for(var s=-1,i=e.length;++s<i;){var o=e[s],a=n(o);if(null!=a&&(u===t?a==a&&!da(a):r(a,u)))var u=a,l=o}return l}function vr(t,e){var n=[];return dr(t,(function(t,r,s){e(t,r,s)&&n.push(t)})),n}function _r(t,e,n,r,s){var i=-1,o=t.length;for(n||(n=_i),s||(s=[]);++i<o;){var a=t[i];e>0&&n(a)?e>1?_r(a,e-1,n,r,s):Oe(s,a):r||(s[s.length]=a)}return s}var yr=Ms(),wr=Ms(!0);function br(t,e){return t&&yr(t,e,La)}function xr(t,e){return t&&wr(t,e,La)}function Ar(t,e){return Ie(e,(function(e){return na(t[e])}))}function Sr(e,n){for(var r=0,s=(n=ws(n,e)).length;null!=e&&r<s;)e=e[Fi(n[r++])];return r&&r==s?e:t}function Rr(t,e,n){var r=e(t);return Ko(t)?r:Oe(r,n(t))}function Ir(e){return null==e?e===t?"[object Undefined]":"[object Null]":ce&&ce in Et(e)?function(e){var n=Lt.call(e,ce),r=e[ce];try{e[ce]=t;var s=!0}catch(o){}var i=Nt.call(e);return s&&(n?e[ce]=r:delete e[ce]),i}(e):function(t){return Nt.call(t)}(e)}function Er(t,e){return t>e}function kr(t,e){return null!=t&&Lt.call(t,e)}function $r(t,e){return null!=t&&e in Et(t)}function Or(e,n,r){for(var s=r?ke:Ee,i=e[0].length,o=e.length,a=o,u=xt(o),l=1/0,c=[];a--;){var f=e[a];a&&n&&(f=$e(f,Je(n))),l=wn(f.length,l),u[a]=!r&&(n||i>=120&&f.length>=120)?new Kn(a&&f):t}f=e[0];var h=-1,d=u[0];t:for(;++h<i&&c.length<l;){var p=f[h],g=n?n(p):p;if(p=r||0!==p?p:0,!(d?Ke(d,g):s(c,g,r))){for(a=o;--a;){var m=u[a];if(!(m?Ke(m,g):s(e[a],g,r)))continue t}d&&d.push(g),c.push(p)}}return c}function Pr(e,n,r){var s=null==(e=ki(e,n=ws(n,e)))?e:e[Fi(to(n))];return null==s?t:be(s,e,r)}function Cr(t){return oa(t)&&Ir(t)==p}function jr(e,n,r,s,i){return e===n||(null==e||null==n||!oa(e)&&!oa(n)?e!=e&&n!=n:function(e,n,r,s,i,o){var a=Ko(e),u=Ko(n),l=a?g:gi(e),c=u?g:gi(n),f=(l=l==p?A:l)==A,h=(c=c==p?A:c)==A,d=l==c;if(d&&Yo(e)){if(!Yo(n))return!1;a=!0,f=!1}if(d&&!f)return o||(o=new Gn),a||pa(e)?ni(e,n,r,s,i,o):function(t,e,n,r,s,i,o){switch(n){case P:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!i(new Ht(t),new Ht(e)));case m:case v:case x:return Ho(+t,+e);case _:return t.name==e.name&&t.message==e.message;case R:case E:return t==e+"";case b:var a=rn;case I:var u=1&r;if(a||(a=an),t.size!=e.size&&!u)return!1;var l=o.get(t);if(l)return l==e;r|=2,o.set(t,e);var c=ni(a(t),a(e),r,s,i,o);return o.delete(t),c;case k:if(Nn)return Nn.call(t)==Nn.call(e)}return!1}(e,n,l,r,s,i,o);if(!(1&r)){var y=f&&Lt.call(e,"__wrapped__"),w=h&&Lt.call(n,"__wrapped__");if(y||w){var S=y?e.value():e,$=w?n.value():n;return o||(o=new Gn),i(S,$,r,s,o)}}return!!d&&(o||(o=new Gn),function(e,n,r,s,i,o){var a=1&r,u=si(e),l=u.length,c=si(n).length;if(l!=c&&!a)return!1;for(var f=l;f--;){var h=u[f];if(!(a?h in n:Lt.call(n,h)))return!1}var d=o.get(e),p=o.get(n);if(d&&p)return d==n&&p==e;var g=!0;o.set(e,n),o.set(n,e);for(var m=a;++f<l;){var v=e[h=u[f]],_=n[h];if(s)var y=a?s(_,v,h,n,e,o):s(v,_,h,e,n,o);if(!(y===t?v===_||i(v,_,r,s,o):y)){g=!1;break}m||(m="constructor"==h)}if(g&&!m){var w=e.constructor,b=n.constructor;w==b||!("constructor"in e)||!("constructor"in n)||"function"==typeof w&&w instanceof w&&"function"==typeof b&&b instanceof b||(g=!1)}return o.delete(e),o.delete(n),g}(e,n,r,s,i,o))}(e,n,r,s,jr,i))}function Tr(e,n,r,s){var i=r.length,o=i,a=!s;if(null==e)return!o;for(e=Et(e);i--;){var u=r[i];if(a&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++i<o;){var l=(u=r[i])[0],c=e[l],f=u[1];if(a&&u[2]){if(c===t&&!(l in e))return!1}else{var h=new Gn;if(s)var d=s(c,f,l,e,n,h);if(!(d===t?jr(f,c,3,s,h):d))return!1}}return!0}function Mr(t){return!(!ia(t)||(e=t,Dt&&Dt in e))&&(na(t)?qt:pt).test(qi(t));var e}function Lr(t){return"function"==typeof t?t:null==t?uu:"object"==typeof t?Ko(t)?qr(t[0],t[1]):Fr(t):vu(t)}function Br(t){if(!Si(t))return _n(t);var e=[];for(var n in Et(t))Lt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Dr(t){if(!ia(t))return function(t){var e=[];if(null!=t)for(var n in Et(t))e.push(n);return e}(t);var e=Si(t),n=[];for(var r in t)("constructor"!=r||!e&&Lt.call(t,r))&&n.push(r);return n}function Nr(t,e){return t<e}function Wr(t,e){var n=-1,r=Qo(t)?xt(t.length):[];return dr(t,(function(t,s,i){r[++n]=e(t,s,i)})),r}function Fr(t){var e=fi(t);return 1==e.length&&e[0][2]?Ii(e[0][0],e[0][1]):function(n){return n===t||Tr(n,t,e)}}function qr(e,n){return bi(e)&&Ri(n)?Ii(Fi(e),n):function(r){var s=Pa(r,e);return s===t&&s===n?Ca(r,e):jr(n,s,3)}}function Ur(e,n,r,s,i){e!==n&&yr(n,(function(o,a){if(i||(i=new Gn),ia(o))!function(e,n,r,s,i,o,a){var u=Oi(e,r),l=Oi(n,r),c=a.get(l);if(c)er(e,r,c);else{var f=o?o(u,l,r+"",e,n,a):t,h=f===t;if(h){var d=Ko(l),p=!d&&Yo(l),g=!d&&!p&&pa(l);f=l,d||p||g?Ko(u)?f=u:Zo(u)?f=Os(u):p?(h=!1,f=Ss(l,!0)):g?(h=!1,f=Is(l,!0)):f=[]:la(l)||Xo(l)?(f=u,Xo(u)?f=xa(u):ia(u)&&!na(u)||(f=vi(l))):h=!1}h&&(a.set(l,f),i(f,l,s,o,a),a.delete(l)),er(e,r,f)}}(e,n,a,r,Ur,s,i);else{var u=s?s(Oi(e,a),o,a+"",e,n,i):t;u===t&&(u=o),er(e,a,u)}}),Ba)}function zr(e,n){var r=e.length;if(r)return yi(n+=n<0?r:0,r)?e[n]:t}function Hr(t,e,n){e=e.length?$e(e,(function(t){return Ko(t)?function(e){return Sr(e,1===t.length?t[0]:t)}:t})):[uu];var r=-1;return e=$e(e,Je(li())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Wr(t,(function(t,n,s){return{criteria:$e(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){for(var r=-1,s=t.criteria,i=e.criteria,o=s.length,a=n.length;++r<o;){var u=Es(s[r],i[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}))}function Vr(t,e,n){for(var r=-1,s=e.length,i={};++r<s;){var o=e[r],a=Sr(t,o);n(a,o)&&ts(i,ws(o,t),a)}return i}function Jr(t,e,n,r){var s=r?De:Be,i=-1,o=e.length,a=t;for(t===e&&(e=Os(e)),n&&(a=$e(t,Je(n)));++i<o;)for(var u=0,l=e[i],c=n?n(l):l;(u=s(a,c,u,r))>-1;)a!==t&&se.call(a,u,1),se.call(t,u,1);return t}function Xr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var s=e[n];if(n==r||s!==i){var i=s;yi(s)?se.call(t,s,1):hs(t,s)}}return t}function Kr(t,e){return t+dn(An()*(e-t+1))}function Gr(t,e){var n="";if(!t||e<1||e>c)return n;do{e%2&&(n+=t),(e=dn(e/2))&&(t+=t)}while(e);return n}function Qr(t,e){return ji(Ei(t,e,uu),t+"")}function Zr(t){return Zn(Ha(t))}function Yr(t,e){var n=Ha(t);return Li(n,ur(e,0,n.length))}function ts(e,n,r,s){if(!ia(e))return e;for(var i=-1,o=(n=ws(n,e)).length,a=o-1,u=e;null!=u&&++i<o;){var l=Fi(n[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=a){var f=u[l];(c=s?s(f,l,u):t)===t&&(c=ia(f)?f:yi(n[i+1])?[]:{})}nr(u,l,c),u=u[l]}return e}var es=Pn?function(t,e){return Pn.set(t,e),t}:uu,ns=fe?function(t,e){return fe(t,"toString",{configurable:!0,enumerable:!1,value:iu(e),writable:!0})}:uu;function rs(t){return Li(Ha(t))}function ss(t,e,n){var r=-1,s=t.length;e<0&&(e=-e>s?0:s+e),(n=n>s?s:n)<0&&(n+=s),s=e>n?0:n-e>>>0,e>>>=0;for(var i=xt(s);++r<s;)i[r]=t[r+e];return i}function is(t,e){var n;return dr(t,(function(t,r,s){return!(n=e(t,r,s))})),!!n}function os(t,e,n){var r=0,s=null==t?r:t.length;if("number"==typeof e&&e==e&&s<=2147483647){for(;r<s;){var i=r+s>>>1,o=t[i];null!==o&&!da(o)&&(n?o<=e:o<e)?r=i+1:s=i}return s}return as(t,e,uu,n)}function as(e,n,r,s){var i=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(n=r(n))!=n,u=null===n,l=da(n),c=n===t;i<o;){var f=dn((i+o)/2),h=r(e[f]),d=h!==t,p=null===h,g=h==h,m=da(h);if(a)var v=s||g;else v=c?g&&(s||d):u?g&&d&&(s||!p):l?g&&d&&!p&&(s||!m):!p&&!m&&(s?h<=n:h<n);v?i=f+1:o=f}return wn(o,4294967294)}function us(t,e){for(var n=-1,r=t.length,s=0,i=[];++n<r;){var o=t[n],a=e?e(o):o;if(!n||!Ho(a,u)){var u=a;i[s++]=0===o?0:o}}return i}function ls(t){return"number"==typeof t?t:da(t)?f:+t}function cs(t){if("string"==typeof t)return t;if(Ko(t))return $e(t,cs)+"";if(da(t))return Wn?Wn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function fs(t,e,n){var r=-1,s=Ee,i=t.length,o=!0,a=[],u=a;if(n)o=!1,s=ke;else if(i>=200){var l=e?null:Gs(t);if(l)return an(l);o=!1,s=Ke,u=new Kn}else u=e?[]:a;t:for(;++r<i;){var c=t[r],f=e?e(c):c;if(c=n||0!==c?c:0,o&&f==f){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),a.push(c)}else s(u,f,n)||(u!==a&&u.push(f),a.push(c))}return a}function hs(t,e){return null==(t=ki(t,e=ws(e,t)))||delete t[Fi(to(e))]}function ds(t,e,n,r){return ts(t,e,n(Sr(t,e)),r)}function ps(t,e,n,r){for(var s=t.length,i=r?s:-1;(r?i--:++i<s)&&e(t[i],i,t););return n?ss(t,r?0:i,r?i+1:s):ss(t,r?i+1:0,r?s:i)}function gs(t,e){var n=t;return n instanceof Hn&&(n=n.value()),Pe(e,(function(t,e){return e.func.apply(e.thisArg,Oe([t],e.args))}),n)}function ms(t,e,n){var r=t.length;if(r<2)return r?fs(t[0]):[];for(var s=-1,i=xt(r);++s<r;)for(var o=t[s],a=-1;++a<r;)a!=s&&(i[s]=hr(i[s]||o,t[a],e,n));return fs(_r(i,1),e,n)}function vs(e,n,r){for(var s=-1,i=e.length,o=n.length,a={};++s<i;){var u=s<o?n[s]:t;r(a,e[s],u)}return a}function _s(t){return Zo(t)?t:[]}function ys(t){return"function"==typeof t?t:uu}function ws(t,e){return Ko(t)?t:bi(t,e)?[t]:Wi(Aa(t))}var bs=Qr;function xs(e,n,r){var s=e.length;return r=r===t?s:r,!n&&r>=s?e:ss(e,n,r)}var As=de||function(t){return le.clearTimeout(t)};function Ss(t,e){if(e)return t.slice();var n=t.length,r=Vt?Vt(n):new t.constructor(n);return t.copy(r),r}function Rs(t){var e=new t.constructor(t.byteLength);return new Ht(e).set(new Ht(t)),e}function Is(t,e){var n=e?Rs(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Es(e,n){if(e!==n){var r=e!==t,s=null===e,i=e==e,o=da(e),a=n!==t,u=null===n,l=n==n,c=da(n);if(!u&&!c&&!o&&e>n||o&&a&&l&&!u&&!c||s&&a&&l||!r&&l||!i)return 1;if(!s&&!o&&!c&&e<n||c&&r&&i&&!s&&!o||u&&r&&i||!a&&i||!l)return-1}return 0}function ks(t,e,n,r){for(var s=-1,i=t.length,o=n.length,a=-1,u=e.length,l=yn(i-o,0),c=xt(u+l),f=!r;++a<u;)c[a]=e[a];for(;++s<o;)(f||s<i)&&(c[n[s]]=t[s]);for(;l--;)c[a++]=t[s++];return c}function $s(t,e,n,r){for(var s=-1,i=t.length,o=-1,a=n.length,u=-1,l=e.length,c=yn(i-a,0),f=xt(c+l),h=!r;++s<c;)f[s]=t[s];for(var d=s;++u<l;)f[d+u]=e[u];for(;++o<a;)(h||s<i)&&(f[d+n[o]]=t[s++]);return f}function Os(t,e){var n=-1,r=t.length;for(e||(e=xt(r));++n<r;)e[n]=t[n];return e}function Ps(e,n,r,s){var i=!r;r||(r={});for(var o=-1,a=n.length;++o<a;){var u=n[o],l=s?s(r[u],e[u],u,r,e):t;l===t&&(l=e[u]),i?or(r,u,l):nr(r,u,l)}return r}function Cs(t,e){return function(n,r){var s=Ko(n)?xe:sr,i=e?e():{};return s(n,t,li(r,2),i)}}function js(e){return Qr((function(n,r){var s=-1,i=r.length,o=i>1?r[i-1]:t,a=i>2?r[2]:t;for(o=e.length>3&&"function"==typeof o?(i--,o):t,a&&wi(r[0],r[1],a)&&(o=i<3?t:o,i=1),n=Et(n);++s<i;){var u=r[s];u&&e(n,u,s,o)}return n}))}function Ts(t,e){return function(n,r){if(null==n)return n;if(!Qo(n))return t(n,r);for(var s=n.length,i=e?s:-1,o=Et(n);(e?i--:++i<s)&&!1!==r(o[i],i,o););return n}}function Ms(t){return function(e,n,r){for(var s=-1,i=Et(e),o=r(e),a=o.length;a--;){var u=o[t?a:++s];if(!1===n(i[u],u,i))break}return e}}function Ls(e){return function(n){var r=nn(n=Aa(n))?ln(n):t,s=r?r[0]:n.charAt(0),i=r?xs(r,1).join(""):n.slice(1);return s[e]()+i}}function Bs(t){return function(e){return Pe(nu(Xa(e).replace(Xt,"")),t,"")}}function Ds(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=qn(t.prototype),r=t.apply(n,e);return ia(r)?r:n}}function Ns(e){return function(n,r,s){var i=Et(n);if(!Qo(n)){var o=li(r,3);n=La(n),r=function(t){return o(i[t],t,i)}}var a=e(n,r,s);return a>-1?i[o?n[a]:a]:t}}function Ws(n){return ri((function(r){var s=r.length,i=s,o=zn.prototype.thru;for(n&&r.reverse();i--;){var a=r[i];if("function"!=typeof a)throw new Ot(e);if(o&&!u&&"wrapper"==ai(a))var u=new zn([],!0)}for(i=u?i:s;++i<s;){var l=ai(a=r[i]),c="wrapper"==l?oi(a):t;u=c&&xi(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?u[ai(c[0])].apply(u,c[3]):1==a.length&&xi(a)?u[l]():u.thru(a)}return function(){var t=arguments,e=t[0];if(u&&1==t.length&&Ko(e))return u.plant(e).value();for(var n=0,i=s?r[n].apply(this,t):e;++n<s;)i=r[n].call(this,i);return i}}))}function Fs(e,n,r,s,i,o,u,l,c,f){var h=n&a,d=1&n,p=2&n,g=24&n,m=512&n,v=p?t:Ds(e);return function t(){for(var a=arguments.length,_=xt(a),y=a;y--;)_[y]=arguments[y];if(g)var w=ui(t),b=Ze(_,w);if(s&&(_=ks(_,s,i,g)),o&&(_=$s(_,o,u,g)),a-=b,g&&a<f){var x=on(_,w);return Xs(e,n,Fs,t.placeholder,r,_,x,l,c,f-a)}var A=d?r:this,S=p?A[e]:e;return a=_.length,l?_=$i(_,l):m&&a>1&&_.reverse(),h&&c<a&&(_.length=c),this&&this!==le&&this instanceof t&&(S=v||Ds(S)),S.apply(A,_)}}function qs(t,e){return function(n,r){return function(t,e,n,r){return br(t,(function(t,s,i){e(r,n(t),s,i)})),r}(n,t,e(r),{})}}function Us(e,n){return function(r,s){var i;if(r===t&&s===t)return n;if(r!==t&&(i=r),s!==t){if(i===t)return s;"string"==typeof r||"string"==typeof s?(r=cs(r),s=cs(s)):(r=ls(r),s=ls(s)),i=e(r,s)}return i}}function zs(t){return ri((function(e){return e=$e(e,Je(li())),Qr((function(n){var r=this;return t(e,(function(t){return be(t,r,n)}))}))}))}function Hs(e,n){var r=(n=n===t?" ":cs(n)).length;if(r<2)return r?Gr(n,e):n;var s=Gr(n,qe(e/un(n)));return nn(n)?xs(ln(s),0,e).join(""):s.slice(0,e)}function Vs(e){return function(n,r,s){return s&&"number"!=typeof s&&wi(n,r,s)&&(r=s=t),n=_a(n),r===t?(r=n,n=0):r=_a(r),function(t,e,n,r){for(var s=-1,i=yn(qe((e-t)/(n||1)),0),o=xt(i);i--;)o[r?i:++s]=t,t+=n;return o}(n,r,s=s===t?n<r?1:-1:_a(s),e)}}function Js(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ba(e),n=ba(n)),t(e,n)}}function Xs(e,n,r,s,a,u,l,c,f,h){var d=8&n;n|=d?i:o,4&(n&=~(d?o:i))||(n&=-4);var p=[e,n,a,d?u:t,d?l:t,d?t:u,d?t:l,c,f,h],g=r.apply(t,p);return xi(e)&&Pi(g,p),g.placeholder=s,Ti(g,e,n)}function Ks(t){var e=It[t];return function(t,n){if(t=ba(t),(n=null==n?0:wn(ya(n),292))&&mn(t)){var r=(Aa(t)+"e").split("e");return+((r=(Aa(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Gs=kn&&1/an(new kn([,-0]))[1]==l?function(t){return new kn(t)}:du;function Qs(t){return function(e){var n=gi(e);return n==b?rn(e):n==I?function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}(e):function(t,e){return $e(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Zs(n,l,c,f,h,d,p,g){var m=2&l;if(!m&&"function"!=typeof n)throw new Ot(e);var v=f?f.length:0;if(v||(l&=-97,f=h=t),p=p===t?p:yn(ya(p),0),g=g===t?g:ya(g),v-=h?h.length:0,l&o){var _=f,y=h;f=h=t}var w=m?t:oi(n),b=[n,l,c,f,h,_,y,d,p,g];if(w&&function(t,e){var n=t[1],s=e[1],i=n|s,o=i<131,l=s==a&&8==n||s==a&&n==u&&t[7].length<=e[8]||384==s&&e[7].length<=e[8]&&8==n;if(!o&&!l)return t;1&s&&(t[2]=e[2],i|=1&n?0:4);var c=e[3];if(c){var f=t[3];t[3]=f?ks(f,c,e[4]):c,t[4]=f?on(t[3],r):e[4]}(c=e[5])&&(f=t[5],t[5]=f?$s(f,c,e[6]):c,t[6]=f?on(t[5],r):e[6]),(c=e[7])&&(t[7]=c),s&a&&(t[8]=null==t[8]?e[8]:wn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(b,w),n=b[0],l=b[1],c=b[2],f=b[3],h=b[4],!(g=b[9]=b[9]===t?m?0:n.length:yn(b[9]-v,0))&&24&l&&(l&=-25),l&&1!=l)x=8==l||l==s?function(e,n,r){var s=Ds(e);return function i(){for(var o=arguments.length,a=xt(o),u=o,l=ui(i);u--;)a[u]=arguments[u];var c=o<3&&a[0]!==l&&a[o-1]!==l?[]:on(a,l);return(o-=c.length)<r?Xs(e,n,Fs,i.placeholder,t,a,c,t,t,r-o):be(this&&this!==le&&this instanceof i?s:e,this,a)}}(n,l,g):l!=i&&33!=l||h.length?Fs.apply(t,b):function(t,e,n,r){var s=1&e,i=Ds(t);return function e(){for(var o=-1,a=arguments.length,u=-1,l=r.length,c=xt(l+a),f=this&&this!==le&&this instanceof e?i:t;++u<l;)c[u]=r[u];for(;a--;)c[u++]=arguments[++o];return be(f,s?n:this,c)}}(n,l,c,f);else var x=function(t,e,n){var r=1&e,s=Ds(t);return function e(){return(this&&this!==le&&this instanceof e?s:t).apply(r?n:this,arguments)}}(n,l,c);return Ti((w?es:Pi)(x,b),n,l)}function Ys(e,n,r,s){return e===t||Ho(e,jt[r])&&!Lt.call(s,r)?n:e}function ti(e,n,r,s,i,o){return ia(e)&&ia(n)&&(o.set(n,e),Ur(e,n,t,ti,o),o.delete(n)),e}function ei(e){return la(e)?t:e}function ni(e,n,r,s,i,o){var a=1&r,u=e.length,l=n.length;if(u!=l&&!(a&&l>u))return!1;var c=o.get(e),f=o.get(n);if(c&&f)return c==n&&f==e;var h=-1,d=!0,p=2&r?new Kn:t;for(o.set(e,n),o.set(n,e);++h<u;){var g=e[h],m=n[h];if(s)var v=a?s(m,g,h,n,e,o):s(g,m,h,e,n,o);if(v!==t){if(v)continue;d=!1;break}if(p){if(!je(n,(function(t,e){if(!Ke(p,e)&&(g===t||i(g,t,r,s,o)))return p.push(e)}))){d=!1;break}}else if(g!==m&&!i(g,m,r,s,o)){d=!1;break}}return o.delete(e),o.delete(n),d}function ri(e){return ji(Ei(e,t,Ki),e+"")}function si(t){return Rr(t,La,di)}function ii(t){return Rr(t,Ba,pi)}var oi=Pn?function(t){return Pn.get(t)}:du;function ai(t){for(var e=t.name+"",n=Cn[e],r=Lt.call(Cn,e)?n.length:0;r--;){var s=n[r],i=s.func;if(null==i||i==t)return s.name}return e}function ui(t){return(Lt.call(Fn,"placeholder")?Fn:t).placeholder}function li(){var t=Fn.iteratee||lu;return t=t===lu?Lr:t,arguments.length?t(arguments[0],arguments[1]):t}function ci(t,e){var n,r,s=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?s["string"==typeof e?"string":"hash"]:s.map}function fi(t){for(var e=La(t),n=e.length;n--;){var r=e[n],s=t[r];e[n]=[r,s,Ri(s)]}return e}function hi(e,n){var r=function(e,n){return null==e?t:e[n]}(e,n);return Mr(r)?r:t}var di=pn?function(t){return null==t?[]:(t=Et(t),Ie(pn(t),(function(e){return Zt.call(t,e)})))}:wu,pi=pn?function(t){for(var e=[];t;)Oe(e,di(t)),t=Jt(t);return e}:wu,gi=Ir;function mi(t,e,n){for(var r=-1,s=(e=ws(e,t)).length,i=!1;++r<s;){var o=Fi(e[r]);if(!(i=null!=t&&n(t,o)))break;t=t[o]}return i||++r!=s?i:!!(s=null==t?0:t.length)&&sa(s)&&yi(o,s)&&(Ko(t)||Xo(t))}function vi(t){return"function"!=typeof t.constructor||Si(t)?{}:qn(Jt(t))}function _i(t){return Ko(t)||Xo(t)||!!(ae&&t&&t[ae])}function yi(t,e){var n=typeof t;return!!(e=null==e?c:e)&&("number"==n||"symbol"!=n&&mt.test(t))&&t>-1&&t%1==0&&t<e}function wi(t,e,n){if(!ia(n))return!1;var r=typeof e;return!!("number"==r?Qo(n)&&yi(e,n.length):"string"==r&&e in n)&&Ho(n[e],t)}function bi(t,e){if(Ko(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!da(t))||Z.test(t)||!Q.test(t)||null!=e&&t in Et(e)}function xi(t){var e=ai(t),n=Fn[e];if("function"!=typeof n||!(e in Hn.prototype))return!1;if(t===n)return!0;var r=oi(n);return!!r&&t===r[0]}(Rn&&gi(new Rn(new ArrayBuffer(1)))!=P||In&&gi(new In)!=b||En&&gi(En.resolve())!=S||kn&&gi(new kn)!=I||$n&&gi(new $n)!=$)&&(gi=function(e){var n=Ir(e),r=n==A?e.constructor:t,s=r?qi(r):"";if(s)switch(s){case jn:return P;case Tn:return b;case Mn:return S;case Ln:return I;case Bn:return $}return n});var Ai=Tt?na:bu;function Si(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||jt)}function Ri(t){return t==t&&!ia(t)}function Ii(e,n){return function(r){return null!=r&&r[e]===n&&(n!==t||e in Et(r))}}function Ei(e,n,r){return n=yn(n===t?e.length-1:n,0),function(){for(var t=arguments,s=-1,i=yn(t.length-n,0),o=xt(i);++s<i;)o[s]=t[n+s];s=-1;for(var a=xt(n+1);++s<n;)a[s]=t[s];return a[n]=r(o),be(e,this,a)}}function ki(t,e){return e.length<2?t:Sr(t,ss(e,0,-1))}function $i(e,n){for(var r=e.length,s=wn(n.length,r),i=Os(e);s--;){var o=n[s];e[s]=yi(o,r)?i[o]:t}return e}function Oi(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Pi=Mi(es),Ci=Te||function(t,e){return le.setTimeout(t,e)},ji=Mi(ns);function Ti(t,e,n){var r=e+"";return ji(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(st,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Ae(d,(function(n){var r="_."+n[0];e&n[1]&&!Ee(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(it);return e?e[1].split(ot):[]}(r),n)))}function Mi(e){var n=0,r=0;return function(){var s=bn(),i=16-(s-r);if(r=s,i>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(t,arguments)}}function Li(e,n){var r=-1,s=e.length,i=s-1;for(n=n===t?s:n;++r<n;){var o=Kr(r,i),a=e[o];e[o]=e[r],e[r]=a}return e.length=n,e}var Bi,Di,Ni,Wi=(Bi=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Y,(function(t,n,r,s){e.push(r?s.replace(lt,"$1"):n||t)})),e},Di=No(Bi,(function(t){return 500===Ni.size&&Ni.clear(),t})),Ni=Di.cache,Di);function Fi(t){if("string"==typeof t||da(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function qi(t){if(null!=t){try{return Mt.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Ui(t){if(t instanceof Hn)return t.clone();var e=new zn(t.__wrapped__,t.__chain__);return e.__actions__=Os(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var zi=Qr((function(t,e){return Zo(t)?hr(t,_r(e,1,Zo,!0)):[]})),Hi=Qr((function(e,n){var r=to(n);return Zo(r)&&(r=t),Zo(e)?hr(e,_r(n,1,Zo,!0),li(r,2)):[]})),Vi=Qr((function(e,n){var r=to(n);return Zo(r)&&(r=t),Zo(e)?hr(e,_r(n,1,Zo,!0),t,r):[]}));function Ji(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var s=null==n?0:ya(n);return s<0&&(s=yn(r+s,0)),Le(t,li(e,3),s)}function Xi(e,n,r){var s=null==e?0:e.length;if(!s)return-1;var i=s-1;return r!==t&&(i=ya(r),i=r<0?yn(s+i,0):wn(i,s-1)),Le(e,li(n,3),i,!0)}function Ki(t){return null!=t&&t.length?_r(t,1):[]}function Gi(e){return e&&e.length?e[0]:t}var Qi=Qr((function(t){var e=$e(t,_s);return e.length&&e[0]===t[0]?Or(e):[]})),Zi=Qr((function(e){var n=to(e),r=$e(e,_s);return n===to(r)?n=t:r.pop(),r.length&&r[0]===e[0]?Or(r,li(n,2)):[]})),Yi=Qr((function(e){var n=to(e),r=$e(e,_s);return(n="function"==typeof n?n:t)&&r.pop(),r.length&&r[0]===e[0]?Or(r,t,n):[]}));function to(e){var n=null==e?0:e.length;return n?e[n-1]:t}var eo=Qr(no);function no(t,e){return t&&t.length&&e&&e.length?Jr(t,e):t}var ro=ri((function(t,e){var n=null==t?0:t.length,r=ar(t,e);return Xr(t,$e(e,(function(t){return yi(t,n)?+t:t})).sort(Es)),r}));function so(t){return null==t?t:Sn.call(t)}var io=Qr((function(t){return fs(_r(t,1,Zo,!0))})),oo=Qr((function(e){var n=to(e);return Zo(n)&&(n=t),fs(_r(e,1,Zo,!0),li(n,2))})),ao=Qr((function(e){var n=to(e);return n="function"==typeof n?n:t,fs(_r(e,1,Zo,!0),t,n)}));function uo(t){if(!t||!t.length)return[];var e=0;return t=Ie(t,(function(t){if(Zo(t))return e=yn(t.length,e),!0})),He(e,(function(e){return $e(t,Fe(e))}))}function lo(e,n){if(!e||!e.length)return[];var r=uo(e);return null==n?r:$e(r,(function(e){return be(n,t,e)}))}var co=Qr((function(t,e){return Zo(t)?hr(t,e):[]})),fo=Qr((function(t){return ms(Ie(t,Zo))})),ho=Qr((function(e){var n=to(e);return Zo(n)&&(n=t),ms(Ie(e,Zo),li(n,2))})),po=Qr((function(e){var n=to(e);return n="function"==typeof n?n:t,ms(Ie(e,Zo),t,n)})),go=Qr(uo),mo=Qr((function(e){var n=e.length,r=n>1?e[n-1]:t;return r="function"==typeof r?(e.pop(),r):t,lo(e,r)}));function vo(t){var e=Fn(t);return e.__chain__=!0,e}function _o(t,e){return e(t)}var yo=ri((function(e){var n=e.length,r=n?e[0]:0,s=this.__wrapped__,i=function(t){return ar(t,e)};return!(n>1||this.__actions__.length)&&s instanceof Hn&&yi(r)?((s=s.slice(r,+r+(n?1:0))).__actions__.push({func:_o,args:[i],thisArg:t}),new zn(s,this.__chain__).thru((function(e){return n&&!e.length&&e.push(t),e}))):this.thru(i)})),wo=Cs((function(t,e,n){Lt.call(t,n)?++t[n]:or(t,n,1)})),bo=Ns(Ji),xo=Ns(Xi);function Ao(t,e){return(Ko(t)?Ae:dr)(t,li(e,3))}function So(t,e){return(Ko(t)?Se:pr)(t,li(e,3))}var Ro=Cs((function(t,e,n){Lt.call(t,n)?t[n].push(e):or(t,n,[e])})),Io=Qr((function(t,e,n){var r=-1,s="function"==typeof e,i=Qo(t)?xt(t.length):[];return dr(t,(function(t){i[++r]=s?be(e,t,n):Pr(t,e,n)})),i})),Eo=Cs((function(t,e,n){or(t,n,e)}));function ko(t,e){return(Ko(t)?$e:Wr)(t,li(e,3))}var $o=Cs((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Oo=Qr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&wi(t,e[0],e[1])?e=[]:n>2&&wi(e[0],e[1],e[2])&&(e=[e[0]]),Hr(t,_r(e,1),[])})),Po=pe||function(){return le.Date.now()};function Co(e,n,r){return n=r?t:n,n=e&&null==n?e.length:n,Zs(e,a,t,t,t,t,n)}function jo(n,r){var s;if("function"!=typeof r)throw new Ot(e);return n=ya(n),function(){return--n>0&&(s=r.apply(this,arguments)),n<=1&&(r=t),s}}var To=Qr((function(t,e,n){var r=1;if(n.length){var s=on(n,ui(To));r|=i}return Zs(t,r,e,n,s)})),Mo=Qr((function(t,e,n){var r=3;if(n.length){var s=on(n,ui(Mo));r|=i}return Zs(e,r,t,n,s)}));function Lo(n,r,s){var i,o,a,u,l,c,f=0,h=!1,d=!1,p=!0;if("function"!=typeof n)throw new Ot(e);function g(e){var r=i,s=o;return i=o=t,f=e,u=n.apply(s,r)}function m(t){return f=t,l=Ci(_,r),h?g(t):u}function v(e){var n=e-c;return c===t||n>=r||n<0||d&&e-f>=a}function _(){var t=Po();if(v(t))return y(t);l=Ci(_,function(t){var e=r-(t-c);return d?wn(e,a-(t-f)):e}(t))}function y(e){return l=t,p&&i?g(e):(i=o=t,u)}function w(){var e=Po(),n=v(e);if(i=arguments,o=this,c=e,n){if(l===t)return m(c);if(d)return As(l),l=Ci(_,r),g(c)}return l===t&&(l=Ci(_,r)),u}return r=ba(r)||0,ia(s)&&(h=!!s.leading,a=(d="maxWait"in s)?yn(ba(s.maxWait)||0,r):a,p="trailing"in s?!!s.trailing:p),w.cancel=function(){l!==t&&As(l),f=0,i=c=o=l=t},w.flush=function(){return l===t?u:y(Po())},w}var Bo=Qr((function(t,e){return fr(t,1,e)})),Do=Qr((function(t,e,n){return fr(t,ba(e)||0,n)}));function No(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw new Ot(e);var r=function(){var e=arguments,s=n?n.apply(this,e):e[0],i=r.cache;if(i.has(s))return i.get(s);var o=t.apply(this,e);return r.cache=i.set(s,o)||i,o};return r.cache=new(No.Cache||Xn),r}function Wo(t){if("function"!=typeof t)throw new Ot(e);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}No.Cache=Xn;var Fo=bs((function(t,e){var n=(e=1==e.length&&Ko(e[0])?$e(e[0],Je(li())):$e(_r(e,1),Je(li()))).length;return Qr((function(r){for(var s=-1,i=wn(r.length,n);++s<i;)r[s]=e[s].call(this,r[s]);return be(t,this,r)}))})),qo=Qr((function(e,n){var r=on(n,ui(qo));return Zs(e,i,t,n,r)})),Uo=Qr((function(e,n){var r=on(n,ui(Uo));return Zs(e,o,t,n,r)})),zo=ri((function(e,n){return Zs(e,u,t,t,t,n)}));function Ho(t,e){return t===e||t!=t&&e!=e}var Vo=Js(Er),Jo=Js((function(t,e){return t>=e})),Xo=Cr(function(){return arguments}())?Cr:function(t){return oa(t)&&Lt.call(t,"callee")&&!Zt.call(t,"callee")},Ko=xt.isArray,Go=ge?Je(ge):function(t){return oa(t)&&Ir(t)==O};function Qo(t){return null!=t&&sa(t.length)&&!na(t)}function Zo(t){return oa(t)&&Qo(t)}var Yo=gn||bu,ta=me?Je(me):function(t){return oa(t)&&Ir(t)==v};function ea(t){if(!oa(t))return!1;var e=Ir(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!la(t)}function na(t){if(!ia(t))return!1;var e=Ir(t);return e==y||e==w||"[object AsyncFunction]"==e||"[object Proxy]"==e}function ra(t){return"number"==typeof t&&t==ya(t)}function sa(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function ia(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function oa(t){return null!=t&&"object"==typeof t}var aa=ve?Je(ve):function(t){return oa(t)&&gi(t)==b};function ua(t){return"number"==typeof t||oa(t)&&Ir(t)==x}function la(t){if(!oa(t)||Ir(t)!=A)return!1;var e=Jt(t);if(null===e)return!0;var n=Lt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Mt.call(n)==Wt}var ca=_e?Je(_e):function(t){return oa(t)&&Ir(t)==R},fa=ye?Je(ye):function(t){return oa(t)&&gi(t)==I};function ha(t){return"string"==typeof t||!Ko(t)&&oa(t)&&Ir(t)==E}function da(t){return"symbol"==typeof t||oa(t)&&Ir(t)==k}var pa=we?Je(we):function(t){return oa(t)&&sa(t.length)&&!!ne[Ir(t)]},ga=Js(Nr),ma=Js((function(t,e){return t<=e}));function va(t){if(!t)return[];if(Qo(t))return ha(t)?ln(t):Os(t);if(ue&&t[ue])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[ue]());var e=gi(t);return(e==b?rn:e==I?an:Ha)(t)}function _a(t){return t?(t=ba(t))===l||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ya(t){var e=_a(t),n=e%1;return e==e?n?e-n:e:0}function wa(t){return t?ur(ya(t),0,h):0}function ba(t){if("number"==typeof t)return t;if(da(t))return f;if(ia(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=ia(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ve(t);var n=dt.test(t);return n||gt.test(t)?oe(t.slice(2),n?2:8):ht.test(t)?f:+t}function xa(t){return Ps(t,Ba(t))}function Aa(t){return null==t?"":cs(t)}var Sa=js((function(t,e){if(Si(e)||Qo(e))Ps(e,La(e),t);else for(var n in e)Lt.call(e,n)&&nr(t,n,e[n])})),Ra=js((function(t,e){Ps(e,Ba(e),t)})),Ia=js((function(t,e,n,r){Ps(e,Ba(e),t,r)})),Ea=js((function(t,e,n,r){Ps(e,La(e),t,r)})),ka=ri(ar),$a=Qr((function(e,n){e=Et(e);var r=-1,s=n.length,i=s>2?n[2]:t;for(i&&wi(n[0],n[1],i)&&(s=1);++r<s;)for(var o=n[r],a=Ba(o),u=-1,l=a.length;++u<l;){var c=a[u],f=e[c];(f===t||Ho(f,jt[c])&&!Lt.call(e,c))&&(e[c]=o[c])}return e})),Oa=Qr((function(e){return e.push(t,ti),be(Na,t,e)}));function Pa(e,n,r){var s=null==e?t:Sr(e,n);return s===t?r:s}function Ca(t,e){return null!=t&&mi(t,e,$r)}var ja=qs((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Nt.call(e)),t[e]=n}),iu(uu)),Ta=qs((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Nt.call(e)),Lt.call(t,e)?t[e].push(n):t[e]=[n]}),li),Ma=Qr(Pr);function La(t){return Qo(t)?Qn(t):Br(t)}function Ba(t){return Qo(t)?Qn(t,!0):Dr(t)}var Da=js((function(t,e,n){Ur(t,e,n)})),Na=js((function(t,e,n,r){Ur(t,e,n,r)})),Wa=ri((function(t,e){var n={};if(null==t)return n;var r=!1;e=$e(e,(function(e){return e=ws(e,t),r||(r=e.length>1),e})),Ps(t,ii(t),n),r&&(n=lr(n,7,ei));for(var s=e.length;s--;)hs(n,e[s]);return n})),Fa=ri((function(t,e){return null==t?{}:function(t,e){return Vr(t,e,(function(e,n){return Ca(t,n)}))}(t,e)}));function qa(t,e){if(null==t)return{};var n=$e(ii(t),(function(t){return[t]}));return e=li(e),Vr(t,n,(function(t,n){return e(t,n[0])}))}var Ua=Qs(La),za=Qs(Ba);function Ha(t){return null==t?[]:Xe(t,La(t))}var Va=Bs((function(t,e,n){return e=e.toLowerCase(),t+(n?Ja(e):e)}));function Ja(t){return eu(Aa(t).toLowerCase())}function Xa(t){return(t=Aa(t))&&t.replace(vt,Ye).replace(Kt,"")}var Ka=Bs((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ga=Bs((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Qa=Ls("toLowerCase"),Za=Bs((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Ya=Bs((function(t,e,n){return t+(n?" ":"")+eu(e)})),tu=Bs((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),eu=Ls("toUpperCase");function nu(e,n,r){return e=Aa(e),(n=r?t:n)===t?function(t){return Yt.test(t)}(e)?function(t){return t.match(Qt)||[]}(e):function(t){return t.match(at)||[]}(e):e.match(n)||[]}var ru=Qr((function(e,n){try{return be(e,t,n)}catch(r){return ea(r)?r:new St(r)}})),su=ri((function(t,e){return Ae(e,(function(e){e=Fi(e),or(t,e,To(t[e],t))})),t}));function iu(t){return function(){return t}}var ou=Ws(),au=Ws(!0);function uu(t){return t}function lu(t){return Lr("function"==typeof t?t:lr(t,1))}var cu=Qr((function(t,e){return function(n){return Pr(n,t,e)}})),fu=Qr((function(t,e){return function(n){return Pr(t,n,e)}}));function hu(t,e,n){var r=La(e),s=Ar(e,r);null!=n||ia(e)&&(s.length||!r.length)||(n=e,e=t,t=this,s=Ar(e,La(e)));var i=!(ia(n)&&"chain"in n&&!n.chain),o=na(t);return Ae(s,(function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),s=n.__actions__=Os(this.__actions__);return s.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Oe([this.value()],arguments))})})),t}function du(){}var pu=zs($e),gu=zs(Re),mu=zs(je);function vu(t){return bi(t)?Fe(Fi(t)):function(t){return function(e){return Sr(e,t)}}(t)}var _u=Vs(),yu=Vs(!0);function wu(){return[]}function bu(){return!1}var xu,Au=Us((function(t,e){return t+e}),0),Su=Ks("ceil"),Ru=Us((function(t,e){return t/e}),1),Iu=Ks("floor"),Eu=Us((function(t,e){return t*e}),1),ku=Ks("round"),$u=Us((function(t,e){return t-e}),0);return Fn.after=function(t,n){if("function"!=typeof n)throw new Ot(e);return t=ya(t),function(){if(--t<1)return n.apply(this,arguments)}},Fn.ary=Co,Fn.assign=Sa,Fn.assignIn=Ra,Fn.assignInWith=Ia,Fn.assignWith=Ea,Fn.at=ka,Fn.before=jo,Fn.bind=To,Fn.bindAll=su,Fn.bindKey=Mo,Fn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ko(t)?t:[t]},Fn.chain=vo,Fn.chunk=function(e,n,r){n=(r?wi(e,n,r):n===t)?1:yn(ya(n),0);var s=null==e?0:e.length;if(!s||n<1)return[];for(var i=0,o=0,a=xt(qe(s/n));i<s;)a[o++]=ss(e,i,i+=n);return a},Fn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,s=[];++e<n;){var i=t[e];i&&(s[r++]=i)}return s},Fn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=xt(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Oe(Ko(n)?Os(n):[n],_r(e,1))},Fn.cond=function(t){var n=null==t?0:t.length,r=li();return t=n?$e(t,(function(t){if("function"!=typeof t[1])throw new Ot(e);return[r(t[0]),t[1]]})):[],Qr((function(e){for(var r=-1;++r<n;){var s=t[r];if(be(s[0],this,e))return be(s[1],this,e)}}))},Fn.conforms=function(t){return function(t){var e=La(t);return function(n){return cr(n,t,e)}}(lr(t,1))},Fn.constant=iu,Fn.countBy=wo,Fn.create=function(t,e){var n=qn(t);return null==e?n:ir(n,e)},Fn.curry=function e(n,r,s){var i=Zs(n,8,t,t,t,t,t,r=s?t:r);return i.placeholder=e.placeholder,i},Fn.curryRight=function e(n,r,i){var o=Zs(n,s,t,t,t,t,t,r=i?t:r);return o.placeholder=e.placeholder,o},Fn.debounce=Lo,Fn.defaults=$a,Fn.defaultsDeep=Oa,Fn.defer=Bo,Fn.delay=Do,Fn.difference=zi,Fn.differenceBy=Hi,Fn.differenceWith=Vi,Fn.drop=function(e,n,r){var s=null==e?0:e.length;return s?ss(e,(n=r||n===t?1:ya(n))<0?0:n,s):[]},Fn.dropRight=function(e,n,r){var s=null==e?0:e.length;return s?ss(e,0,(n=s-(n=r||n===t?1:ya(n)))<0?0:n):[]},Fn.dropRightWhile=function(t,e){return t&&t.length?ps(t,li(e,3),!0,!0):[]},Fn.dropWhile=function(t,e){return t&&t.length?ps(t,li(e,3),!0):[]},Fn.fill=function(e,n,r,s){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&wi(e,n,r)&&(r=0,s=i),function(e,n,r,s){var i=e.length;for((r=ya(r))<0&&(r=-r>i?0:i+r),(s=s===t||s>i?i:ya(s))<0&&(s+=i),s=r>s?0:wa(s);r<s;)e[r++]=n;return e}(e,n,r,s)):[]},Fn.filter=function(t,e){return(Ko(t)?Ie:vr)(t,li(e,3))},Fn.flatMap=function(t,e){return _r(ko(t,e),1)},Fn.flatMapDeep=function(t,e){return _r(ko(t,e),l)},Fn.flatMapDepth=function(e,n,r){return r=r===t?1:ya(r),_r(ko(e,n),r)},Fn.flatten=Ki,Fn.flattenDeep=function(t){return null!=t&&t.length?_r(t,l):[]},Fn.flattenDepth=function(e,n){return null!=e&&e.length?_r(e,n=n===t?1:ya(n)):[]},Fn.flip=function(t){return Zs(t,512)},Fn.flow=ou,Fn.flowRight=au,Fn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var s=t[e];r[s[0]]=s[1]}return r},Fn.functions=function(t){return null==t?[]:Ar(t,La(t))},Fn.functionsIn=function(t){return null==t?[]:Ar(t,Ba(t))},Fn.groupBy=Ro,Fn.initial=function(t){return null!=t&&t.length?ss(t,0,-1):[]},Fn.intersection=Qi,Fn.intersectionBy=Zi,Fn.intersectionWith=Yi,Fn.invert=ja,Fn.invertBy=Ta,Fn.invokeMap=Io,Fn.iteratee=lu,Fn.keyBy=Eo,Fn.keys=La,Fn.keysIn=Ba,Fn.map=ko,Fn.mapKeys=function(t,e){var n={};return e=li(e,3),br(t,(function(t,r,s){or(n,e(t,r,s),t)})),n},Fn.mapValues=function(t,e){var n={};return e=li(e,3),br(t,(function(t,r,s){or(n,r,e(t,r,s))})),n},Fn.matches=function(t){return Fr(lr(t,1))},Fn.matchesProperty=function(t,e){return qr(t,lr(e,1))},Fn.memoize=No,Fn.merge=Da,Fn.mergeWith=Na,Fn.method=cu,Fn.methodOf=fu,Fn.mixin=hu,Fn.negate=Wo,Fn.nthArg=function(t){return t=ya(t),Qr((function(e){return zr(e,t)}))},Fn.omit=Wa,Fn.omitBy=function(t,e){return qa(t,Wo(li(e)))},Fn.once=function(t){return jo(2,t)},Fn.orderBy=function(e,n,r,s){return null==e?[]:(Ko(n)||(n=null==n?[]:[n]),Ko(r=s?t:r)||(r=null==r?[]:[r]),Hr(e,n,r))},Fn.over=pu,Fn.overArgs=Fo,Fn.overEvery=gu,Fn.overSome=mu,Fn.partial=qo,Fn.partialRight=Uo,Fn.partition=$o,Fn.pick=Fa,Fn.pickBy=qa,Fn.property=vu,Fn.propertyOf=function(e){return function(n){return null==e?t:Sr(e,n)}},Fn.pull=eo,Fn.pullAll=no,Fn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Jr(t,e,li(n,2)):t},Fn.pullAllWith=function(e,n,r){return e&&e.length&&n&&n.length?Jr(e,n,t,r):e},Fn.pullAt=ro,Fn.range=_u,Fn.rangeRight=yu,Fn.rearg=zo,Fn.reject=function(t,e){return(Ko(t)?Ie:vr)(t,Wo(li(e,3)))},Fn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,s=[],i=t.length;for(e=li(e,3);++r<i;){var o=t[r];e(o,r,t)&&(n.push(o),s.push(r))}return Xr(t,s),n},Fn.rest=function(n,r){if("function"!=typeof n)throw new Ot(e);return Qr(n,r=r===t?r:ya(r))},Fn.reverse=so,Fn.sampleSize=function(e,n,r){return n=(r?wi(e,n,r):n===t)?1:ya(n),(Ko(e)?Yn:Yr)(e,n)},Fn.set=function(t,e,n){return null==t?t:ts(t,e,n)},Fn.setWith=function(e,n,r,s){return s="function"==typeof s?s:t,null==e?e:ts(e,n,r,s)},Fn.shuffle=function(t){return(Ko(t)?tr:rs)(t)},Fn.slice=function(e,n,r){var s=null==e?0:e.length;return s?(r&&"number"!=typeof r&&wi(e,n,r)?(n=0,r=s):(n=null==n?0:ya(n),r=r===t?s:ya(r)),ss(e,n,r)):[]},Fn.sortBy=Oo,Fn.sortedUniq=function(t){return t&&t.length?us(t):[]},Fn.sortedUniqBy=function(t,e){return t&&t.length?us(t,li(e,2)):[]},Fn.split=function(e,n,r){return r&&"number"!=typeof r&&wi(e,n,r)&&(n=r=t),(r=r===t?h:r>>>0)?(e=Aa(e))&&("string"==typeof n||null!=n&&!ca(n))&&!(n=cs(n))&&nn(e)?xs(ln(e),0,r):e.split(n,r):[]},Fn.spread=function(t,n){if("function"!=typeof t)throw new Ot(e);return n=null==n?0:yn(ya(n),0),Qr((function(e){var r=e[n],s=xs(e,0,n);return r&&Oe(s,r),be(t,this,s)}))},Fn.tail=function(t){var e=null==t?0:t.length;return e?ss(t,1,e):[]},Fn.take=function(e,n,r){return e&&e.length?ss(e,0,(n=r||n===t?1:ya(n))<0?0:n):[]},Fn.takeRight=function(e,n,r){var s=null==e?0:e.length;return s?ss(e,(n=s-(n=r||n===t?1:ya(n)))<0?0:n,s):[]},Fn.takeRightWhile=function(t,e){return t&&t.length?ps(t,li(e,3),!1,!0):[]},Fn.takeWhile=function(t,e){return t&&t.length?ps(t,li(e,3)):[]},Fn.tap=function(t,e){return e(t),t},Fn.throttle=function(t,n,r){var s=!0,i=!0;if("function"!=typeof t)throw new Ot(e);return ia(r)&&(s="leading"in r?!!r.leading:s,i="trailing"in r?!!r.trailing:i),Lo(t,n,{leading:s,maxWait:n,trailing:i})},Fn.thru=_o,Fn.toArray=va,Fn.toPairs=Ua,Fn.toPairsIn=za,Fn.toPath=function(t){return Ko(t)?$e(t,Fi):da(t)?[t]:Os(Wi(Aa(t)))},Fn.toPlainObject=xa,Fn.transform=function(t,e,n){var r=Ko(t),s=r||Yo(t)||pa(t);if(e=li(e,4),null==n){var i=t&&t.constructor;n=s?r?new i:[]:ia(t)&&na(i)?qn(Jt(t)):{}}return(s?Ae:br)(t,(function(t,r,s){return e(n,t,r,s)})),n},Fn.unary=function(t){return Co(t,1)},Fn.union=io,Fn.unionBy=oo,Fn.unionWith=ao,Fn.uniq=function(t){return t&&t.length?fs(t):[]},Fn.uniqBy=function(t,e){return t&&t.length?fs(t,li(e,2)):[]},Fn.uniqWith=function(e,n){return n="function"==typeof n?n:t,e&&e.length?fs(e,t,n):[]},Fn.unset=function(t,e){return null==t||hs(t,e)},Fn.unzip=uo,Fn.unzipWith=lo,Fn.update=function(t,e,n){return null==t?t:ds(t,e,ys(n))},Fn.updateWith=function(e,n,r,s){return s="function"==typeof s?s:t,null==e?e:ds(e,n,ys(r),s)},Fn.values=Ha,Fn.valuesIn=function(t){return null==t?[]:Xe(t,Ba(t))},Fn.without=co,Fn.words=nu,Fn.wrap=function(t,e){return qo(ys(e),t)},Fn.xor=fo,Fn.xorBy=ho,Fn.xorWith=po,Fn.zip=go,Fn.zipObject=function(t,e){return vs(t||[],e||[],nr)},Fn.zipObjectDeep=function(t,e){return vs(t||[],e||[],ts)},Fn.zipWith=mo,Fn.entries=Ua,Fn.entriesIn=za,Fn.extend=Ra,Fn.extendWith=Ia,hu(Fn,Fn),Fn.add=Au,Fn.attempt=ru,Fn.camelCase=Va,Fn.capitalize=Ja,Fn.ceil=Su,Fn.clamp=function(e,n,r){return r===t&&(r=n,n=t),r!==t&&(r=(r=ba(r))==r?r:0),n!==t&&(n=(n=ba(n))==n?n:0),ur(ba(e),n,r)},Fn.clone=function(t){return lr(t,4)},Fn.cloneDeep=function(t){return lr(t,5)},Fn.cloneDeepWith=function(e,n){return lr(e,5,n="function"==typeof n?n:t)},Fn.cloneWith=function(e,n){return lr(e,4,n="function"==typeof n?n:t)},Fn.conformsTo=function(t,e){return null==e||cr(t,e,La(e))},Fn.deburr=Xa,Fn.defaultTo=function(t,e){return null==t||t!=t?e:t},Fn.divide=Ru,Fn.endsWith=function(e,n,r){e=Aa(e),n=cs(n);var s=e.length,i=r=r===t?s:ur(ya(r),0,s);return(r-=n.length)>=0&&e.slice(r,i)==n},Fn.eq=Ho,Fn.escape=function(t){return(t=Aa(t))&&J.test(t)?t.replace(H,tn):t},Fn.escapeRegExp=function(t){return(t=Aa(t))&&et.test(t)?t.replace(tt,"\\$&"):t},Fn.every=function(e,n,r){var s=Ko(e)?Re:gr;return r&&wi(e,n,r)&&(n=t),s(e,li(n,3))},Fn.find=bo,Fn.findIndex=Ji,Fn.findKey=function(t,e){return Me(t,li(e,3),br)},Fn.findLast=xo,Fn.findLastIndex=Xi,Fn.findLastKey=function(t,e){return Me(t,li(e,3),xr)},Fn.floor=Iu,Fn.forEach=Ao,Fn.forEachRight=So,Fn.forIn=function(t,e){return null==t?t:yr(t,li(e,3),Ba)},Fn.forInRight=function(t,e){return null==t?t:wr(t,li(e,3),Ba)},Fn.forOwn=function(t,e){return t&&br(t,li(e,3))},Fn.forOwnRight=function(t,e){return t&&xr(t,li(e,3))},Fn.get=Pa,Fn.gt=Vo,Fn.gte=Jo,Fn.has=function(t,e){return null!=t&&mi(t,e,kr)},Fn.hasIn=Ca,Fn.head=Gi,Fn.identity=uu,Fn.includes=function(t,e,n,r){t=Qo(t)?t:Ha(t),n=n&&!r?ya(n):0;var s=t.length;return n<0&&(n=yn(s+n,0)),ha(t)?n<=s&&t.indexOf(e,n)>-1:!!s&&Be(t,e,n)>-1},Fn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var s=null==n?0:ya(n);return s<0&&(s=yn(r+s,0)),Be(t,e,s)},Fn.inRange=function(e,n,r){return n=_a(n),r===t?(r=n,n=0):r=_a(r),function(t,e,n){return t>=wn(e,n)&&t<yn(e,n)}(e=ba(e),n,r)},Fn.invoke=Ma,Fn.isArguments=Xo,Fn.isArray=Ko,Fn.isArrayBuffer=Go,Fn.isArrayLike=Qo,Fn.isArrayLikeObject=Zo,Fn.isBoolean=function(t){return!0===t||!1===t||oa(t)&&Ir(t)==m},Fn.isBuffer=Yo,Fn.isDate=ta,Fn.isElement=function(t){return oa(t)&&1===t.nodeType&&!la(t)},Fn.isEmpty=function(t){if(null==t)return!0;if(Qo(t)&&(Ko(t)||"string"==typeof t||"function"==typeof t.splice||Yo(t)||pa(t)||Xo(t)))return!t.length;var e=gi(t);if(e==b||e==I)return!t.size;if(Si(t))return!Br(t).length;for(var n in t)if(Lt.call(t,n))return!1;return!0},Fn.isEqual=function(t,e){return jr(t,e)},Fn.isEqualWith=function(e,n,r){var s=(r="function"==typeof r?r:t)?r(e,n):t;return s===t?jr(e,n,t,r):!!s},Fn.isError=ea,Fn.isFinite=function(t){return"number"==typeof t&&mn(t)},Fn.isFunction=na,Fn.isInteger=ra,Fn.isLength=sa,Fn.isMap=aa,Fn.isMatch=function(t,e){return t===e||Tr(t,e,fi(e))},Fn.isMatchWith=function(e,n,r){return r="function"==typeof r?r:t,Tr(e,n,fi(n),r)},Fn.isNaN=function(t){return ua(t)&&t!=+t},Fn.isNative=function(t){if(Ai(t))throw new St("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Mr(t)},Fn.isNil=function(t){return null==t},Fn.isNull=function(t){return null===t},Fn.isNumber=ua,Fn.isObject=ia,Fn.isObjectLike=oa,Fn.isPlainObject=la,Fn.isRegExp=ca,Fn.isSafeInteger=function(t){return ra(t)&&t>=-9007199254740991&&t<=c},Fn.isSet=fa,Fn.isString=ha,Fn.isSymbol=da,Fn.isTypedArray=pa,Fn.isUndefined=function(e){return e===t},Fn.isWeakMap=function(t){return oa(t)&&gi(t)==$},Fn.isWeakSet=function(t){return oa(t)&&"[object WeakSet]"==Ir(t)},Fn.join=function(t,e){return null==t?"":vn.call(t,e)},Fn.kebabCase=Ka,Fn.last=to,Fn.lastIndexOf=function(e,n,r){var s=null==e?0:e.length;if(!s)return-1;var i=s;return r!==t&&(i=(i=ya(r))<0?yn(s+i,0):wn(i,s-1)),n==n?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(e,n,i):Le(e,Ne,i,!0)},Fn.lowerCase=Ga,Fn.lowerFirst=Qa,Fn.lt=ga,Fn.lte=ma,Fn.max=function(e){return e&&e.length?mr(e,uu,Er):t},Fn.maxBy=function(e,n){return e&&e.length?mr(e,li(n,2),Er):t},Fn.mean=function(t){return We(t,uu)},Fn.meanBy=function(t,e){return We(t,li(e,2))},Fn.min=function(e){return e&&e.length?mr(e,uu,Nr):t},Fn.minBy=function(e,n){return e&&e.length?mr(e,li(n,2),Nr):t},Fn.stubArray=wu,Fn.stubFalse=bu,Fn.stubObject=function(){return{}},Fn.stubString=function(){return""},Fn.stubTrue=function(){return!0},Fn.multiply=Eu,Fn.nth=function(e,n){return e&&e.length?zr(e,ya(n)):t},Fn.noConflict=function(){return le._===this&&(le._=Ft),this},Fn.noop=du,Fn.now=Po,Fn.pad=function(t,e,n){t=Aa(t);var r=(e=ya(e))?un(t):0;if(!e||r>=e)return t;var s=(e-r)/2;return Hs(dn(s),n)+t+Hs(qe(s),n)},Fn.padEnd=function(t,e,n){t=Aa(t);var r=(e=ya(e))?un(t):0;return e&&r<e?t+Hs(e-r,n):t},Fn.padStart=function(t,e,n){t=Aa(t);var r=(e=ya(e))?un(t):0;return e&&r<e?Hs(e-r,n)+t:t},Fn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),xn(Aa(t).replace(nt,""),e||0)},Fn.random=function(e,n,r){if(r&&"boolean"!=typeof r&&wi(e,n,r)&&(n=r=t),r===t&&("boolean"==typeof n?(r=n,n=t):"boolean"==typeof e&&(r=e,e=t)),e===t&&n===t?(e=0,n=1):(e=_a(e),n===t?(n=e,e=0):n=_a(n)),e>n){var s=e;e=n,n=s}if(r||e%1||n%1){var i=An();return wn(e+i*(n-e+ie("1e-"+((i+"").length-1))),n)}return Kr(e,n)},Fn.reduce=function(t,e,n){var r=Ko(t)?Pe:Ue,s=arguments.length<3;return r(t,li(e,4),n,s,dr)},Fn.reduceRight=function(t,e,n){var r=Ko(t)?Ce:Ue,s=arguments.length<3;return r(t,li(e,4),n,s,pr)},Fn.repeat=function(e,n,r){return n=(r?wi(e,n,r):n===t)?1:ya(n),Gr(Aa(e),n)},Fn.replace=function(){var t=arguments,e=Aa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Fn.result=function(e,n,r){var s=-1,i=(n=ws(n,e)).length;for(i||(i=1,e=t);++s<i;){var o=null==e?t:e[Fi(n[s])];o===t&&(s=i,o=r),e=na(o)?o.call(e):o}return e},Fn.round=ku,Fn.runInContext=rt,Fn.sample=function(t){return(Ko(t)?Zn:Zr)(t)},Fn.size=function(t){if(null==t)return 0;if(Qo(t))return ha(t)?un(t):t.length;var e=gi(t);return e==b||e==I?t.size:Br(t).length},Fn.snakeCase=Za,Fn.some=function(e,n,r){var s=Ko(e)?je:is;return r&&wi(e,n,r)&&(n=t),s(e,li(n,3))},Fn.sortedIndex=function(t,e){return os(t,e)},Fn.sortedIndexBy=function(t,e,n){return as(t,e,li(n,2))},Fn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=os(t,e);if(r<n&&Ho(t[r],e))return r}return-1},Fn.sortedLastIndex=function(t,e){return os(t,e,!0)},Fn.sortedLastIndexBy=function(t,e,n){return as(t,e,li(n,2),!0)},Fn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=os(t,e,!0)-1;if(Ho(t[n],e))return n}return-1},Fn.startCase=Ya,Fn.startsWith=function(t,e,n){return t=Aa(t),n=null==n?0:ur(ya(n),0,t.length),e=cs(e),t.slice(n,n+e.length)==e},Fn.subtract=$u,Fn.sum=function(t){return t&&t.length?ze(t,uu):0},Fn.sumBy=function(t,e){return t&&t.length?ze(t,li(e,2)):0},Fn.template=function(e,n,r){var s=Fn.templateSettings;r&&wi(e,n,r)&&(n=t),e=Aa(e),n=Ia({},n,s,Ys);var i,o,a=Ia({},n.imports,s.imports,Ys),u=La(a),l=Xe(a,u),c=0,f=n.interpolate||_t,h="__p += '",d=kt((n.escape||_t).source+"|"+f.source+"|"+(f===G?ct:_t).source+"|"+(n.evaluate||_t).source+"|$","g"),p="//# sourceURL="+(Lt.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ee+"]")+"\n";e.replace(d,(function(t,n,r,s,a,u){return r||(r=s),h+=e.slice(c,u).replace(yt,en),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),a&&(o=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=u+t.length,t})),h+="';\n";var g=Lt.call(n,"variable")&&n.variable;if(g){if(ut.test(g))throw new St("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(o?h.replace(F,""):h).replace(q,"$1").replace(U,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=ru((function(){return Rt(u,p+"return "+h).apply(t,l)}));if(m.source=h,ea(m))throw m;return m},Fn.times=function(t,e){if((t=ya(t))<1||t>c)return[];var n=h,r=wn(t,h);e=li(e),t-=h;for(var s=He(r,e);++n<t;)e(n);return s},Fn.toFinite=_a,Fn.toInteger=ya,Fn.toLength=wa,Fn.toLower=function(t){return Aa(t).toLowerCase()},Fn.toNumber=ba,Fn.toSafeInteger=function(t){return t?ur(ya(t),-9007199254740991,c):0===t?t:0},Fn.toString=Aa,Fn.toUpper=function(t){return Aa(t).toUpperCase()},Fn.trim=function(e,n,r){if((e=Aa(e))&&(r||n===t))return Ve(e);if(!e||!(n=cs(n)))return e;var s=ln(e),i=ln(n);return xs(s,Ge(s,i),Qe(s,i)+1).join("")},Fn.trimEnd=function(e,n,r){if((e=Aa(e))&&(r||n===t))return e.slice(0,cn(e)+1);if(!e||!(n=cs(n)))return e;var s=ln(e);return xs(s,0,Qe(s,ln(n))+1).join("")},Fn.trimStart=function(e,n,r){if((e=Aa(e))&&(r||n===t))return e.replace(nt,"");if(!e||!(n=cs(n)))return e;var s=ln(e);return xs(s,Ge(s,ln(n))).join("")},Fn.truncate=function(e,n){var r=30,s="...";if(ia(n)){var i="separator"in n?n.separator:i;r="length"in n?ya(n.length):r,s="omission"in n?cs(n.omission):s}var o=(e=Aa(e)).length;if(nn(e)){var a=ln(e);o=a.length}if(r>=o)return e;var u=r-un(s);if(u<1)return s;var l=a?xs(a,0,u).join(""):e.slice(0,u);if(i===t)return l+s;if(a&&(u+=l.length-u),ca(i)){if(e.slice(u).search(i)){var c,f=l;for(i.global||(i=kt(i.source,Aa(ft.exec(i))+"g")),i.lastIndex=0;c=i.exec(f);)var h=c.index;l=l.slice(0,h===t?u:h)}}else if(e.indexOf(cs(i),u)!=u){var d=l.lastIndexOf(i);d>-1&&(l=l.slice(0,d))}return l+s},Fn.unescape=function(t){return(t=Aa(t))&&V.test(t)?t.replace(z,fn):t},Fn.uniqueId=function(t){var e=++Bt;return Aa(t)+e},Fn.upperCase=tu,Fn.upperFirst=eu,Fn.each=Ao,Fn.eachRight=So,Fn.first=Gi,hu(Fn,(xu={},br(Fn,(function(t,e){Lt.call(Fn.prototype,e)||(xu[e]=t)})),xu),{chain:!1}),Fn.VERSION="4.17.21",Ae(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Fn[t].placeholder=Fn})),Ae(["drop","take"],(function(e,n){Hn.prototype[e]=function(r){r=r===t?1:yn(ya(r),0);var s=this.__filtered__&&!n?new Hn(this):this.clone();return s.__filtered__?s.__takeCount__=wn(r,s.__takeCount__):s.__views__.push({size:wn(r,h),type:e+(s.__dir__<0?"Right":"")}),s},Hn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Ae(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Hn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:li(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),Ae(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Hn.prototype[t]=function(){return this[n](1).value()[0]}})),Ae(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Hn.prototype[t]=function(){return this.__filtered__?new Hn(this):this[n](1)}})),Hn.prototype.compact=function(){return this.filter(uu)},Hn.prototype.find=function(t){return this.filter(t).head()},Hn.prototype.findLast=function(t){return this.reverse().find(t)},Hn.prototype.invokeMap=Qr((function(t,e){return"function"==typeof t?new Hn(this):this.map((function(n){return Pr(n,t,e)}))})),Hn.prototype.reject=function(t){return this.filter(Wo(li(t)))},Hn.prototype.slice=function(e,n){e=ya(e);var r=this;return r.__filtered__&&(e>0||n<0)?new Hn(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),n!==t&&(r=(n=ya(n))<0?r.dropRight(-n):r.take(n-e)),r)},Hn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Hn.prototype.toArray=function(){return this.take(h)},br(Hn.prototype,(function(e,n){var r=/^(?:filter|find|map|reject)|While$/.test(n),s=/^(?:head|last)$/.test(n),i=Fn[s?"take"+("last"==n?"Right":""):n],o=s||/^find/.test(n);i&&(Fn.prototype[n]=function(){var n=this.__wrapped__,a=s?[1]:arguments,u=n instanceof Hn,l=a[0],c=u||Ko(n),f=function(t){var e=i.apply(Fn,Oe([t],a));return s&&h?e[0]:e};c&&r&&"function"==typeof l&&1!=l.length&&(u=c=!1);var h=this.__chain__,d=!!this.__actions__.length,p=o&&!h,g=u&&!d;if(!o&&c){n=g?n:new Hn(this);var m=e.apply(n,a);return m.__actions__.push({func:_o,args:[f],thisArg:t}),new zn(m,h)}return p&&g?e.apply(this,a):(m=this.thru(f),p?s?m.value()[0]:m.value():m)})})),Ae(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Pt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Fn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var s=this.value();return e.apply(Ko(s)?s:[],t)}return this[n]((function(n){return e.apply(Ko(n)?n:[],t)}))}})),br(Hn.prototype,(function(t,e){var n=Fn[e];if(n){var r=n.name+"";Lt.call(Cn,r)||(Cn[r]=[]),Cn[r].push({name:e,func:n})}})),Cn[Fs(t,2).name]=[{name:"wrapper",func:t}],Hn.prototype.clone=function(){var t=new Hn(this.__wrapped__);return t.__actions__=Os(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Os(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Os(this.__views__),t},Hn.prototype.reverse=function(){if(this.__filtered__){var t=new Hn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Hn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ko(t),r=e<0,s=n?t.length:0,i=function(t,e,n){for(var r=-1,s=n.length;++r<s;){var i=n[r],o=i.size;switch(i.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=wn(e,t+o);break;case"takeRight":t=yn(t,e-o)}}return{start:t,end:e}}(0,s,this.__views__),o=i.start,a=i.end,u=a-o,l=r?a:o-1,c=this.__iteratees__,f=c.length,h=0,d=wn(u,this.__takeCount__);if(!n||!r&&s==u&&d==u)return gs(t,this.__actions__);var p=[];t:for(;u--&&h<d;){for(var g=-1,m=t[l+=e];++g<f;){var v=c[g],_=v.iteratee,y=v.type,w=_(m);if(2==y)m=w;else if(!w){if(1==y)continue t;break t}}p[h++]=m}return p},Fn.prototype.at=yo,Fn.prototype.chain=function(){return vo(this)},Fn.prototype.commit=function(){return new zn(this.value(),this.__chain__)},Fn.prototype.next=function(){this.__values__===t&&(this.__values__=va(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?t:this.__values__[this.__index__++]}},Fn.prototype.plant=function(e){for(var n,r=this;r instanceof Un;){var s=Ui(r);s.__index__=0,s.__values__=t,n?i.__wrapped__=s:n=s;var i=s;r=r.__wrapped__}return i.__wrapped__=e,n},Fn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Hn){var n=e;return this.__actions__.length&&(n=new Hn(this)),(n=n.reverse()).__actions__.push({func:_o,args:[so],thisArg:t}),new zn(n,this.__chain__)}return this.thru(so)},Fn.prototype.toJSON=Fn.prototype.valueOf=Fn.prototype.value=function(){return gs(this.__wrapped__,this.__actions__)},Fn.prototype.first=Fn.prototype.head,ue&&(Fn.prototype[ue]=function(){return this}),Fn}();fe?((fe.exports=hn)._=hn,ce._=hn):le._=hn}.call(_s);var ws=ys.exports;const bs=["电商","运营","商品","转化","流量","GMV","ROI","复购","促销","直播","用户增长","活动","营销","数据","分析","客单价","留存率","复购率"];const xs=_({data:()=>({inputMessage:"",chatHistory:[],isLoading:!1,showReasoning:{},showTopicWarning:!1,roleMap:{user:"您",assistant:"电商专家"},openai:null}),computed:{isInputValid(){return this.inputMessage.trim().length>2&&!this.showTopicWarning&&bs.some((t=>this.inputMessage.toLowerCase().includes(t.toLowerCase())))}},watch:{chatHistory:{handler:"scrollToBottom",deep:!0}},mounted(){this.openai=new gs({apiKey:"sk-37f06f4f3ce84c9e9eaa4ed6c926dbd9",baseURL:"https://dashscope.aliyuncs.com/compatible-mode/v1",dangerouslyAllowBrowser:!0}),this.addWelcomeMessage()},methods:{async sendMessage(){if(this.isInputValid&&!this.isLoading)try{this.isLoading=!0;const t={role:"user",content:this.inputMessage,timestamp:Date.now()};this.chatHistory.push(t);const e={role:"assistant",content:"",timestamp:Date.now(),isStreaming:!0};this.chatHistory.push(e);const n=[{role:"system",content:"你是一名专业的电商运营专家，专注于商品运营、流量转化、活动策划、用户增长和数据分析。请用专业但易懂的方式回答电商相关问题。"},...this.chatHistory.filter((t=>"system"!==t.role)).map((t=>({role:t.role,content:t.content})))],r=await this.openai.chat.completions.create({model:"qwen-plus",messages:n,temperature:.7,max_tokens:1e3}),s=this.chatHistory.length-1;this.chatHistory[s].content=r.choices[0].message.content,this.chatHistory[s].isStreaming=!1,this.inputMessage=""}catch(t){console.error("API调用失败:",t),this.handleError(t.message)}finally{this.isLoading=!1}},validateTopic:ws.debounce((function(){this.showTopicWarning=this.inputMessage.length>0&&!bs.some((t=>this.inputMessage.toLowerCase().includes(t.toLowerCase())))}),300),handleError(t){this.chatHistory.push({role:"assistant",content:"服务暂时不可用",errorMessage:t,timestamp:Date.now()})},addWelcomeMessage(){this.chatHistory.push({role:"assistant",content:"您好！我是电商运营专家，可以咨询以下问题：\n\n• 如何策划促销活动？\n• 怎样提升商品转化率？\n• 用户增长的有效方法\n• 直播带货的运营技巧",timestamp:Date.now()})},newLine(){this.inputMessage+="\n",this.$nextTick((()=>this.adjustTextAreaHeight()))},toggleReasoning(t){this.$set(this.showReasoning,t,!this.showReasoning[t])},formatTime:t=>new Date(t).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),adjustTextAreaHeight:ws.debounce((function(){const t=this.$refs.textArea;t.style.height="auto",t.style.height=`${Math.min(t.scrollHeight,200)}px`}),100),scrollToBottom(){this.$nextTick((()=>{const t=this.$refs.messageList;t.scrollTop=t.scrollHeight}))}}},[["render",function(_,y,w,b,x,A){const S=f,R=h;return d(),t("div",{class:"chat-container"},[e("div",{class:"welcome-banner"},[e("h3",null,"📚 电商运营智能助手"),e("p",null,[n("欢迎咨询以下电商相关问题："),e("br"),n(" 商品运营 | 流量转化 | 活动策划 | 用户增长 | 数据分析")])]),e("div",{class:"message-list",ref:"messageList"},[(d(!0),t(r,null,s(x.chatHistory,((n,r)=>(d(),t("div",{key:r,class:c(["message-item",n.role])},[e("div",{class:"message-card"},[e("div",{class:"message-header"},[e("span",{class:"role-tag"},p(x.roleMap[n.role]),1),e("span",{class:"time"},p(A.formatTime(n.timestamp)),1)]),e("div",{class:"message-content"},[e("pre",null,p(n.content),1),n.isError?(d(),t("div",{key:0,class:"error-message"},[e("i",{class:"icon-warning"},"⚠️"),e("span",null,p(n.errorMessage),1)])):u("",!0),n.isStreaming?(d(),t("div",{key:1,class:"streaming-indicator"},"▋")):u("",!0)]),n.reasoning?(d(),t("div",{key:0,class:"reasoning-box"},[e("div",{class:"reasoning-header",onClick:t=>A.toggleReasoning(r)},[e("span",null,"思考过程"),e("i",{class:c(["arrow",x.showReasoning[r]?"up":"down"])},null,2)],8,["onClick"]),i(v,{name:"slide"},{default:l((()=>[g(e("pre",{class:"reasoning-content"},p(n.reasoning),513),[[m,x.showReasoning[r]]])])),_:2},1024)])):u("",!0)])],2)))),128))],512),e("div",{class:"input-container"},[e("div",{class:"input-box"},[i(S,{modelValue:x.inputMessage,"onUpdate:modelValue":y[0]||(y[0]=t=>x.inputMessage=t),placeholder:"请输入电商运营相关问题，例如：如何提升双十一活动转化率？",onKeydown:[o(a(A.sendMessage,["exact","prevent"]),["enter"]),o(a(A.newLine,["shift"]),["enter"])],disabled:x.isLoading,ref:"textArea",onInput:A.validateTopic},null,8,["modelValue","onKeydown","disabled","onInput"]),x.showTopicWarning?(d(),t("div",{key:0,class:"topic-warning"},[e("i",{class:"icon-info"},"ℹ️"),e("span",null,"请提问电商运营相关问题（涉及商品、流量、转化率、用户增长等）")])):u("",!0),i(R,{class:c(["send-button",{loading:x.isLoading}]),onClick:A.sendMessage,disabled:x.isLoading||!A.isInputValid},{default:l((()=>[x.isLoading?(d(),t("div",{key:1,class:"loader"})):(d(),t("span",{key:0},"发送"))])),_:1},8,["class","onClick","disabled"])])])])}],["__scopeId","data-v-9f10cdfb"]]);export{xs as default};
