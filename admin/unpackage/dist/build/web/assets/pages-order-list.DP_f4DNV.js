import{k as t,n as e,b as a,w as s,i as r,o as l,d,e as o,t as n,f as u,h as c,G as i,F as f,j as h,E as _,B as m,p as S}from"./index-ClAhF9Bg.js";import{g as D}from"./order.BEdhMf4z.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./request.QWExmb5c.js";const g=p({data:()=>({allOrders:[],statusList:["已付款","待发货","已发货","已完成"],currentStatus:"",startDate:"",endDate:"",currentDate:"",orderStats:{todayCount:0,todayAmount:0,totalCount:0,totalAmount:"0.00"}}),computed:{filteredOrders(){return this.allOrders.filter((t=>!this.currentStatus||t.orderStatus===this.currentStatus)).sort(((t,e)=>new Date(e.createdAt)-new Date(t.createdAt)))},currentStats(){const t=(new Date).toISOString().split("T")[0],e=this.filteredOrders,a=e.filter((e=>new Date(e.createdAt).toISOString().split("T")[0]===t));return{todayCount:a.length,todayAmount:a.reduce(((t,e)=>t+Number(e.totalPrice)),0).toFixed(2),totalCount:e.length,totalAmount:e.reduce(((t,e)=>t+Number(e.totalPrice)),0).toFixed(2)}}},created(){const t=new Date;this.currentDate=this.formatDate(t),this.endDate=this.currentDate,this.startDate=this.formatDate(new Date(t.setDate(t.getDate()-7)))},onLoad(){this.loadOrders()},onShow(){this.loadOrders()},methods:{async loadOrders(){try{const t=await D();1===t.code&&(this.allOrders=t.data,this.orderStats=this.currentStats,console.log("订单数据已刷新"))}catch(e){console.error("获取订单列表失败:",e),t({title:"获取订单列表失败",icon:"none"})}},handleStatusChange(t){this.currentStatus=t,this.orderStats=this.currentStats},onStartDateChange(t){this.startDate=t.detail.value,this.orderStats=this.currentStats},onEndDateChange(t){this.endDate=t.detail.value,this.orderStats=this.currentStats},formatDate:t=>t.toISOString().split("T")[0],formatTime:t=>t||"",handleEdit(t){e({url:`/pages/order/edit?orderInfo=${encodeURIComponent(JSON.stringify(t))}`})}},watch:{currentStatus(){this.orderStats=this.currentStats},startDate(){this.orderStats=this.currentStats},endDate(){this.orderStats=this.currentStats}}},[["render",function(t,e,D,p,g,C){const v=h,y=r,O=_,w=m,A=S;return l(),a(y,{class:"container"},{default:s((()=>[d(y,{class:"statistics-card"},{default:s((()=>[d(y,{class:"stat-item"},{default:s((()=>[d(v,{class:"stat-value"},{default:s((()=>[o(n(g.orderStats.todayCount),1)])),_:1}),d(v,{class:"stat-label"},{default:s((()=>[o("今日订单")])),_:1})])),_:1}),d(y,{class:"stat-item"},{default:s((()=>[d(v,{class:"stat-value"},{default:s((()=>[o("¥"+n(g.orderStats.todayAmount),1)])),_:1}),d(v,{class:"stat-label"},{default:s((()=>[o("今日金额")])),_:1})])),_:1}),d(y,{class:"stat-item"},{default:s((()=>[d(v,{class:"stat-value"},{default:s((()=>[o(n(g.orderStats.totalCount),1)])),_:1}),d(v,{class:"stat-label"},{default:s((()=>[o("总订单")])),_:1})])),_:1}),d(y,{class:"stat-item"},{default:s((()=>[d(v,{class:"stat-value"},{default:s((()=>[o("¥"+n(g.orderStats.totalAmount),1)])),_:1}),d(v,{class:"stat-label"},{default:s((()=>[o("总金额")])),_:1})])),_:1})])),_:1}),d(y,{class:"status-filter"},{default:s((()=>[(l(!0),u(f,null,c(g.statusList,((t,e)=>(l(),a(y,{key:e,class:i(["status-item",g.currentStatus===t?"active":""]),onClick:e=>C.handleStatusChange(t)},{default:s((()=>[o(n(t),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),d(y,{class:"date-filter"},{default:s((()=>[d(O,{mode:"date",value:g.startDate,end:g.endDate,onChange:C.onStartDateChange},{default:s((()=>[d(y,{class:"picker-item"},{default:s((()=>[d(v,null,{default:s((()=>[o("开始日期："+n(g.startDate),1)])),_:1})])),_:1})])),_:1},8,["value","end","onChange"]),d(v,null,{default:s((()=>[o("至")])),_:1}),d(O,{mode:"date",value:g.endDate,start:g.startDate,end:g.currentDate,onChange:C.onEndDateChange},{default:s((()=>[d(y,{class:"picker-item"},{default:s((()=>[d(v,null,{default:s((()=>[o("结束日期："+n(g.endDate),1)])),_:1})])),_:1})])),_:1},8,["value","start","end","onChange"])])),_:1}),d(y,{class:"order-list"},{default:s((()=>[(l(!0),u(f,null,c(C.filteredOrders,(t=>(l(),a(y,{key:t.id,class:"order-item"},{default:s((()=>[d(y,{class:"order-header"},{default:s((()=>[d(v,{class:"order-id"},{default:s((()=>[o("订单号："+n(t.orderId),1)])),_:2},1024),d(v,{class:"order-status"},{default:s((()=>[o(n(t.orderStatus),1)])),_:2},1024)])),_:2},1024),d(y,{class:"order-content"},{default:s((()=>[d(w,{src:t.productImage,mode:"aspectFill",class:"product-image"},null,8,["src"]),d(y,{class:"order-info"},{default:s((()=>[d(v,{class:"product-name"},{default:s((()=>[o(n(t.productName),1)])),_:2},1024),d(v,{class:"product-desc"},{default:s((()=>[o(n(t.productDesc),1)])),_:2},1024),d(y,{class:"price-info"},{default:s((()=>[d(v,null,{default:s((()=>[o("¥"+n(t.price)+" × "+n(t.quantity),1)])),_:2},1024),d(v,{class:"total-price"},{default:s((()=>[o("总计：¥"+n(t.totalPrice),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),d(y,{class:"delivery-info"},{default:s((()=>[d(v,null,{default:s((()=>[o("收货人："+n(t.recipientName),1)])),_:2},1024),d(v,null,{default:s((()=>[o("联系电话："+n(t.recipientPhone||"无"),1)])),_:2},1024),d(v,null,{default:s((()=>[o("收货地址："+n(t.addressDetail),1)])),_:2},1024)])),_:2},1024),d(y,{class:"order-footer"},{default:s((()=>[d(v,{class:"order-time"},{default:s((()=>[o("下单时间："+n(C.formatTime(t.createdAt)),1)])),_:2},1024),d(A,{class:"action-btn",onClick:e=>C.handleEdit(t)},{default:s((()=>[o("修改状态")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})}],["__scopeId","data-v-cfa1501a"]]);export{g as default};
