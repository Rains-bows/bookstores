import{k as e,n as a,s as t,b as s,w as c,i,o as d,d as n,e as o,q as r,f as l,h as u,t as h,F as g,I as p,p as f,j as k}from"./index-ClAhF9Bg.js";import{s as P,g as _,d as m}from"./product.AbqVjqrU.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./request.QWExmb5c.js";const C=y({data:()=>({products:[],currentPage:1,pageSize:10,keyword:"",total:0,isSearching:!1}),onLoad(){this.loadProducts()},onShow(){this.loadProducts()},methods:{async loadProducts(){try{const a=this.isSearching?await P(this.keyword,this.currentPage,this.pageSize):await _(this.currentPage,this.pageSize);1===a.code?this.products=a.data:e({title:a.message||"获取商品列表失败",icon:"none"})}catch(a){e({title:"获取商品列表失败",icon:"none"})}},async handleSearch(){if(!this.keyword.trim())return this.isSearching=!1,this.currentPage=1,void this.loadProducts();try{this.isSearching=!0,this.currentPage=1;const e=await P(this.keyword,this.currentPage,this.pageSize);1===e.code&&(this.products=e.data)}catch(a){e({title:"搜索失败",icon:"none"})}},navigateToAdd(){a({url:"/pages/product/edit"})},handleEdit(e){a({url:`/pages/product/edit?id=${e.id}`})},async handleDelete(a){t({title:"提示",content:"确定要删除该商品吗？",success:async t=>{if(t.confirm)try{const t=await m(a);1===t.code?(e({title:"删除成功",icon:"success"}),await this.loadProducts()):e({title:t.message||"删除失败",icon:"none"})}catch(s){e({title:"删除失败",icon:"none"})}}})},handlePageChange(e){this.currentPage=e,this.loadProducts()},resetSearch(){this.keyword="",this.isSearching=!1,this.currentPage=1,this.loadProducts()}}},[["render",function(e,a,t,P,_,m){const y=p,C=f,S=i,b=k;return d(),s(S,{class:"container"},{default:c((()=>[n(S,{class:"search-box"},{default:c((()=>[n(y,{type:"text",modelValue:_.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>_.keyword=e),placeholder:"请输入商品名称搜索",class:"search-input"},null,8,["modelValue"]),n(C,{onClick:m.handleSearch,class:"search-btn"},{default:c((()=>[o("搜索")])),_:1},8,["onClick"]),_.isSearching?(d(),s(C,{key:0,onClick:m.resetSearch,class:"reset-btn"},{default:c((()=>[o("重置")])),_:1},8,["onClick"])):r("",!0)])),_:1}),n(C,{onClick:m.navigateToAdd,class:"add-btn"},{default:c((()=>[o("添加商品")])),_:1},8,["onClick"]),n(S,{class:"product-list"},{default:c((()=>[(d(!0),l(g,null,u(_.products,(e=>(d(),s(S,{key:e.id,class:"product-item"},{default:c((()=>[n(S,{class:"product-info"},{default:c((()=>[n(b,{class:"product-name"},{default:c((()=>[o(h(e.name),1)])),_:2},1024),n(b,{class:"product-price"},{default:c((()=>[o("￥"+h(e.price),1)])),_:2},1024)])),_:2},1024),n(S,{class:"product-actions"},{default:c((()=>[n(C,{onClick:a=>m.handleEdit(e),class:"btn edit-btn"},{default:c((()=>[o("编辑")])),_:2},1032,["onClick"]),n(C,{onClick:a=>m.handleDelete(e.id),class:"btn delete-btn"},{default:c((()=>[o("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),n(S,{class:"pagination"},{default:c((()=>[n(C,{disabled:_.currentPage<=1,onClick:a[1]||(a[1]=e=>m.handlePageChange(_.currentPage-1)),class:"page-btn"},{default:c((()=>[o("上一页")])),_:1},8,["disabled"]),n(b,{class:"page-text"},{default:c((()=>[o("第 "+h(_.currentPage)+" 页",1)])),_:1}),n(C,{onClick:a[2]||(a[2]=e=>m.handlePageChange(_.currentPage+1)),class:"page-btn"},{default:c((()=>[o("下一页")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-8d3bd0ca"]]);export{C as default};
