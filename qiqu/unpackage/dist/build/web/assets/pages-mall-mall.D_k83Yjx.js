import{_ as a,s as e,g as t,a as s,r as o,n as c,b as l,c as r,d as i,w as d,i as n,o as u,e as g,f as m,h,j as f,F as _,k as p,S as y,l as C,m as k,t as w,p as P,q as b}from"./index-DfJFPZaM.js";import{s as j,g as R,a as I}from"./product.Dc_v3CX8.js";import"./request.D0Ryayp7.js";const v=a({data:()=>({banners:[{image:"/static/images/bg1.jpeg"},{image:"/static/images/bg2.jpeg"},{image:"/static/images/bg3.jpeg"}],categories:[],currentCategory:null,recommendProducts:[],searchKeyword:""}),onLoad(){this.getCategories(),this.getRecommendProducts()},onPullDownRefresh(){this.getRecommendProducts(),setTimeout((()=>{e()}),1e3)},methods:{async getRecommendProducts(){try{if(t("token")||(s({title:"还没登录"}),o({url:"/pages/login/login"})),this.searchKeyword){const a=await j(this.searchKeyword);1===a.code&&a.data&&(this.recommendProducts=a.data.map((a=>({...a,soldCount:Math.floor(81*Math.random())+20}))))}else{const a=await R();1===a.code&&a.data&&a.data.length>0&&(this.recommendProducts=this.getRandomItems(a.data,5).map((a=>({...a,soldCount:Math.floor(81*Math.random())+20}))))}console.log("推荐商品:",this.recommendProducts)}catch(a){console.error("获取商品失败:",a),s({title:"获取商品失败",icon:"none"})}},getRandomItems:(a,e)=>[...a].sort((()=>.5-Math.random())).slice(0,e),goSearch(){c({url:"/pages/search/index"})},goDetail(a){c({url:`/pages/product/detail?id=${a}`})},async getCategories(){try{const a=await I();1===a.code&&a.data&&(this.categories=a.data,this.categories.length>0&&(this.currentCategory=this.categories[0].id))}catch(a){console.error("获取分类失败:",a)}},goCategory(a){this.currentCategory=a,l("selectedCategoryId",a),r({url:"/pages/category/category",fail:a=>{console.error("跳转失败:",a),s({title:"跳转失败",icon:"none"})}})},handleSearch(a){this.searchKeyword=a,this.getRecommendProducts()}}},[["render",function(a,e,t,s,o,c){const l=p,r=n,j=P,R=b,I=y,v=C;return u(),i(r,{class:"container"},{default:d((()=>[g(r,{class:"header"},{default:d((()=>[g(r,{class:"search-bar"},{default:d((()=>[g(r,{class:"search-input",onClick:c.goSearch},{default:d((()=>[g(l,{class:"iconfont icon-search"}),g(l,{class:"placeholder"},{default:d((()=>[m("搜索商品")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),g(I,{class:"banner animate__animated animate__fadeIn","indicator-dots":!0,autoplay:!0,interval:3e3,duration:500,"indicator-active-color":"#FFC300"},{default:d((()=>[(u(!0),h(_,null,f(o.banners,((a,e)=>(u(),i(R,{key:e,class:"animate__animated animate__fadeIn"},{default:d((()=>[g(j,{src:a.image,mode:"aspectFill"},null,8,["src"])])),_:2},1024)))),128))])),_:1}),g(r,{class:"category-nav"},{default:d((()=>[g(v,{"scroll-x":"",class:"category-scroll"},{default:d((()=>[(u(!0),h(_,null,f(o.categories,(a=>(u(),i(r,{class:k(["category-item",{active:o.currentCategory===a.id}]),key:a.id,onClick:e=>c.goCategory(a.id)},{default:d((()=>[g(l,null,{default:d((()=>[m(w(a.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),g(r,{class:"recommend"},{default:d((()=>[g(r,{class:"section-title"},{default:d((()=>[g(l,{class:"title"},{default:d((()=>[m("猜你喜欢")])),_:1}),g(l,{class:"subtitle"},{default:d((()=>[m("为你精选好物")])),_:1})])),_:1}),g(r,{class:"product-list"},{default:d((()=>[(u(!0),h(_,null,f(o.recommendProducts,(a=>(u(),i(r,{class:"product-item",key:a.id,onClick:e=>c.goDetail(a.id)},{default:d((()=>[g(j,{src:a.image||"/static/images/default.png",mode:"aspectFill"},null,8,["src"]),g(r,{class:"info"},{default:d((()=>[g(l,{class:"name"},{default:d((()=>[m(w(a.name),1)])),_:2},1024),g(r,{class:"price-wrap"},{default:d((()=>[g(l,{class:"price"},{default:d((()=>[m("¥"+w(a.price),1)])),_:2},1024),g(l,{class:"sold"},{default:d((()=>[m("已售"+w(a.soldCount||0)+"件",1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-6419102e"]]);export{v as default};
